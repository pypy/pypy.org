<!DOCTYPE html>
<html \ prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A Faster Python">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PyPy (old posts, page 2) | PyPy</title>
<link href="../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../rss.xml">
<link rel="canonical" href="https://www.pypy.org/blog/index-2.html">
<link rel="icon" href="../favicon2.ico" sizes="16x16">
<link rel="icon" href="../favicon32x32.ico" sizes="32x32">
<link rel="prev" href="index-3.html" type="text/html">
<link rel="next" href="index-1.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../assets/css/tipuesearch.css">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../index.html">
                    <image id="toplogo" src="../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../compat.html">Compatibility</a> </li>  
                    <li> <a href="../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href=".">Index</a> </li>  
                    <li> <a href="../categories/">Tags</a> </li>  
                    <li> <a href="../archive.html">Archive by year</a> </li>  
                    <li> <a href="../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://bsky.app/profile/pypyproject.bsky.social">Bluesky</a> </li>  
                    <li> <a href="https://libera.irclog.whitequark.org/pypy">IRC logs</a> </li>  
                    <li> <a href="https://www.youtube.com/playlist?list=PLADqad94yVqDRQXuqxKrPS5QnVqbDLlRt">YouTube</a> </li>  
                    <li> <a href="https://www.twitch.tv/pypyproject">Twitch</a> </li>  
                    <li> <a href="../pypy-sponsors.html">Sponsors</a> </li>  
                    <li> <a href="../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section><div class="searchform" role="search">
                
<form class="navbar-form navbar-left" action="../search.html" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Searchâ€¦" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;">
</form>

            </div>
    </header><main id="content"><div class="post">
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2008/01/visualizing-python-tokenizer-5020282079473796926.html" class="u-url">Visualizing a Python tokenizer</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2008/01/visualizing-python-tokenizer-5020282079473796926.html" rel="bookmark">
            <time class="published dt-published" datetime="2008-01-08T11:22:00Z" itemprop="datePublished" title="2008-01-08 11:22">2008-01-08 11:22</time></a>
            </p>
                <p class="commentline">11 comments</p>

        </div>
    </header><div class="p-summary entry-summary">
    <p>Armin and me have been working on PyPy's parser and bytecode compiler for the Python language in the last days. Armin implemented several bytecode optimizations that CPython has since a while whereas I tried to refactor our tokenizer and parser (because our existing parser is rather slow and also not very nice code). Armin is mostly done whereas the new parser is not very far yet.</p> <p>What is done, however, is the Python tokenizer. It is implemented in the usual way, by using a set of <a href="https://en.wikipedia.org/wiki/Regular_expression#Formal_language_theory">regular expressions</a> to generate a <a href="https://en.wikipedia.org/wiki/Deterministic_finite_state_machine">deterministic finite automaton</a> (DFA). This automaton is then turned into a big function which does the actual tokenization. Of course the picture is not quite as simple for Python, because it is not possible to tokenize Python using only regular expressions. To generate the proper "indent" and "dedent" tokens it would be necessary to keep state (the previous indentation levels) which a DFA cannot do. This is solved by postprocessing the tokens that the tokenizer produces to turn whitespace tokens into the proper indent and dedent tokens.</p>
<p>For debugging purposes I implemented a visualization tool for DFAs using PyPy's <a href="https://pygame.org/">pygame</a>-based <a href="https://codespeak.net/viewvc/pypy/dist/dotviewer/">graph viewer</a>. The graph viewer is able to visualize interactively any graph given in the graph-description language of <a href="https://graphviz.or/">Graphviz</a>. Looking at the tokenizing DFA for Python is rather instructive, both for understanding how tokenizing works and (maybe) for understanding the Python language. To try it, download the <a href="https://codespeak.net/%7Ecfbolz/tokenizer.dot">dot file of the DFA</a> and run from a pypy checkout:</p>
<p></p>
<pre>$ python pypy/bin/dotviewer.py tokenizer.dot</pre>
<p></p>The following is a screenshot of the graphviewer:
<a href="https://2.bp.blogspot.com/_zICyAWqZbLA/R4NutbgbocI/AAAAAAAAADU/QPPOLMVWp50/s1600-h/graphviewer.png"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5153084125398933954" src="https://2.bp.blogspot.com/_zICyAWqZbLA/R4NutbgbocI/AAAAAAAAADU/QPPOLMVWp50/s320/graphviewer.png" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer;"></a>
<p>For people who don't want do checkout PyPy I generated a (rather big) <a href="https://codespeak.net/%7Ecfbolz/tokenizer.png">png</a> for the DFA.</p>
<p>Next thing I would like to do (apart from actually finishing the parser, of course :-) ) is visualize the Python grammar itself using <a href="https://en.wikipedia.org/wiki/Syntax_diagram">syntax diagrams</a> or something similar. So far I couldn't really find a program to do that, though.</p>
    </div>
    </article><div class="comment-level comment-level-1">
      <div class="comment comment-8609048123951649403">
        <div class="comment-header">
          <a name="comment-8609048123951649403"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2008-01-08 16:11</span>:
        </div>
        <div class="comment-content">
          <p>Have you seen <a href="https://flickr.com/photos/nicksieger/281055485/" rel="nofollow">this graph of the Python grammar</a>?</p>
        </div>
      </div>
      <div class="comment comment-412620991796584808">
        <div class="comment-header">
          <a name="comment-412620991796584808"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2008-01-08 17:52</span>:
        </div>
        <div class="comment-content">
          <p>Hi Robin,<br><br>Yes, this is sort of cool already, but it doesn't really give you as much information as the grammar itself. It's more of an overview-like thing.<br><br>Cheers,<br><br>Carl Friedrich</p>
        </div>
      </div>
      <div class="comment comment-8479632687054194065">
        <div class="comment-header">
          <a name="comment-8479632687054194065"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2008-01-08 18:05</span>:
        </div>
        <div class="comment-content">
          <p>Check out ANTLRWorks or ANTLRStudio for superb visualization of grammars.</p>
        </div>
      </div>
      <div class="comment comment-401799603589975858">
        <div class="comment-header">
          <a name="comment-401799603589975858"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2008-01-09 13:57</span>:
        </div>
        <div class="comment-content">
          <p>Yeah, ANTLRWorks seems pretty nice in that respect. Thanks for the hint.</p>
        </div>
      </div>
      <div class="comment comment-5114166570848791420">
        <div class="comment-header">
          <a name="comment-5114166570848791420"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2008-01-18 13:52</span>:
        </div>
        <div class="comment-content">
          <p>Hello!<br><br>I was considering to use<br><br>https://www.antlr.org/wiki/display/ANTLR3/Antlr3PythonTarget<br><br>for a toy language project for uni (Computer Engineering, IT) because I guess ANTLR(works) and its mailing list could help me a lot in understanding the very basics of 'grammar design'...<br><br>Or at least I hope so! :-)<br><br>However, I've also been lurking the PyPy ml for quite a while now and was considering the possibility to implement the whole (*toy*) interpreter in RPython, so to understand a bit more of PyPy's design by actually coding something simple which makes some use of it. :-)<br><br>So, would you consider trying to port the current ANTLR's Python runtime to RPython a good way for me to start doing something with PyPy?<br><br>Would you consider the thing interesting? I know this possibility had been discussed on IRC some times ago and it wasn't thought to be that useful at last, but maybe you discussed the thing some more since then and changed idea, I don't know...<br><br>How would you rate the difficulty of such a task for a PyPy and ANTLR newbie, also? :-)<br><br>I wouldn't try doing that right now, anyway, but maybe in March I should manage to get some spare time for it. In the meantime, I'd try to read as many docs and sources as possible...<br><br>Tell me your opinion, please! :-)<br><br>Cheers,<br>Matteo<br><br>PS: I'm writing here because you were discussing PyPy's Python lexer and somebody wrote about ANTLRworks, but if you think I'd better send this message to the list please just tell me and I'll do so! :-)</p>
        </div>
      </div>
      <div class="comment comment-4541453163496650443">
        <div class="comment-header">
          <a name="comment-4541453163496650443"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2008-01-18 16:32</span>:
        </div>
        <div class="comment-content">
          <p>Hi Matteo,<br><br>I would post to the pypy-dev mailing list instead, it is better to discuss such longish things there. Thanks for you interest!<br><br>Cheers,<br><br>Carl Friedrich</p>
        </div>
      </div>
      <div class="comment comment-2852285688121849523">
        <div class="comment-header">
          <a name="comment-2852285688121849523"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2008-05-19 14:45</span>:
        </div>
        <div class="comment-content">
          <p>Does it use Graphviz's dot utility for rendering?</p>
        </div>
      </div>
      <div class="comment comment-8592064228245777392">
        <div class="comment-header">
          <a name="comment-8592064228245777392"></a>
            <span class="author">Konrad</span> wrote on <span class="date">2008-06-04 18:36</span>:
        </div>
        <div class="comment-content">
          <p>@techtonik<br><br>Yes, it does.</p>
        </div>
      </div>
      <div class="comment comment-5017852604858126060">
        <div class="comment-header">
          <a name="comment-5017852604858126060"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2008-06-04 18:47</span>:
        </div>
        <div class="comment-content">
          <p>That's bad it cann't be used as a standalone product without the need to install Graphvis.</p>
        </div>
      </div>
      <div class="comment comment-7758160831434035110">
        <div class="comment-header">
          <a name="comment-7758160831434035110"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2009-04-22 02:22</span>:
        </div>
        <div class="comment-content">
          <p>cheap <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow power leveling</a> cheapest <a href="https://www.wowpowerleveling.me/" rel="nofollow">wow power leveling</a> buy <a href="https://www.wowgold-powerleveling.com/wow-powerleveling.asp" rel="nofollow">wow power leveling</a> CHEAP <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">power leveling</a> CHEAPEST <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow gold</a> BUY <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow powerleveling</a></p>
        </div>
      </div>
      <div class="comment comment-3274058047501054546">
        <div class="comment-header">
          <a name="comment-3274058047501054546"></a>
            <span class="author">wow power leveling</span> wrote on <span class="date">2009-04-22 02:27</span>:
        </div>
        <div class="comment-content">
          <p>cheap <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow power leveling</a> cheapest <a href="https://www.wowpowerleveling.me/" rel="nofollow">wow power leveling</a> buy <a href="https://www.wowgold-powerleveling.com/wow-powerleveling.asp" rel="nofollow">wow power leveling</a> CHEAP <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">power leveling</a> CHEAPEST <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow gold</a> BUY <a href="https://www.wowgold-powerleveling.com/" rel="nofollow">wow powerleveling</a></p>
        </div>
      </div>
         </div>

    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/pypy-winter-sports-sprint-from-12-19th-5592383212609773292.html" class="u-url">PyPy Winter Sports Sprint from 12-19th of January in Leysin, Switzerland</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/pypy-winter-sports-sprint-from-12-19th-5592383212609773292.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-31T16:02:00Z" itemprop="datePublished" title="2007-12-31 16:02">2007-12-31 16:02</time></a>
            </p>
            
        </div>
    </header><div class="p-summary entry-summary">
    <table border="0">
<tr><td colspan="3">
<p>The next PyPy sprint will be held in Leysin, Switzerland, for
the fifth time.  The overall idea of the sprint is to continue
working on making PyPy ready for general use.</p>
</td></tr>
<tr>
<td valign="top">
<p>The proposed topics are: ctypes, JIT, testing, LLVM.  This is
a fully public sprint, so newcomers and other topics are
welcome.  And like previous winters, the main side goal is to
have fun in winter sports :-) See the <a class="reference" href="https://codespeak.net/pypy/extradoc/sprintinfo/leysin-winter-2008/announcement.html">sprint announcement</a>
for details.</p>
</td>
<td>Â 
</td>
<td><img src="https://www.ermina.ch/002.JPG"></td>
</tr>
</table>
</div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/german-slides-of-talk-at-python-user-3715884461725333051.html" class="u-url">(German) Slides of Talk at Python User Group Munich Available</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/german-slides-of-talk-at-python-user-3715884461725333051.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-20T15:42:00Z" itemprop="datePublished" title="2007-12-20 15:42">2007-12-20 15:42</time></a>
            </p>
            
        </div>
    </header><div class="p-summary entry-summary">
    <p>Georg Brandl has <a href="https://pyside.blogspot.com/2007/12/german-pypy-talk.html">put up the slides</a> of the <a href="../posts/2007/12/pypy-talk-at-python-user-group-munich-1952379593354367249.html">PyPy talk</a> he gave at the Python User Group Munich.  The slides are in German.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/various-performance-improvements-7027210611565246190.html" class="u-url">Various Performance Improvements</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/various-performance-improvements-7027210611565246190.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-20T14:37:00Z" itemprop="datePublished" title="2007-12-20 14:37">2007-12-20 14:37</time></a>
            </p>
                <p class="commentline">1 comment</p>

        </div>
    </header><div class="p-summary entry-summary">
    <p>A few days ago, Armin discovered <a href="https://www.gnuplot.info/">Gnuplot</a>. He wrote a script that turns the results of the <a href="https://tuatara.cs.uni-duesseldorf.de/benchmark.html">nightly benchmark</a> runs into <a href="https://wyvern.cs.uni-duesseldorf.de/%7Earigo/plots.html">plots</a> (lower is always better, all the numbers of the microbenchmarks are "times slower than CPython"). The corresponding microbenchmarks can be <a href="https://codespeak.net/svn/pypy/dist/pypy/translator/microbench/">found in the repository</a>. Staring at the plots revealed a strange performance regression around the revision 45000. After some investigation Armin found that an mostly unrelated change had disabled our method cache, which caused the regression. This was fixed.

In addition, Armin did a few other small tweaks in the interpreter main loop, making sure that small bytecodes are inlined into the main loop. This gave another few percent of performance increase. Together with the GC improvements two weeks ago this leads to the fastest non-JIT PyPy ever. Unfortunately "fastest" is not really very fast yet in absolute terms, with realistic apps being around 3-4 times slower than CPython. Especially calls (in all its variants) are quite slow, which is something we should look into.</p>
    </div>
    </article><div class="comment-level comment-level-1">
      <div class="comment comment-5304148766835082345">
        <div class="comment-header">
          <a name="comment-5304148766835082345"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2008-01-06 06:05</span>:
        </div>
        <div class="comment-content">
          <p>I'm amazed by the progress you guys have made. 3 - 4 times slower than CPython is actually really good considering what it does!<br><br>PyPy is one of the most interesting computer language projects on the net.</p>
        </div>
      </div>
         </div>

    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/faster-implementation-of-classic-1021557618590043616.html" class="u-url">Faster implementation of classic classes merged</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/faster-implementation-of-classic-1021557618590043616.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-14T13:42:00Z" itemprop="datePublished" title="2007-12-14 13:42">2007-12-14 13:42</time></a>
            </p>
                <p class="commentline">5 comments</p>

        </div>
    </header><div class="p-summary entry-summary">
    <p>Old-style classes have so far been a bit neglected by PyPy's Python interpreter. By default, PyPy makes all classes new-style and you have to use a command-line switch (--oldstyle) at startup or at translation time to change that default. Then you would get an pure-Python implementation of classic classes. This implementation was extremely slow (around 20 times slower than classic classes in CPython). In the past we had hoped that we could get away with mostly only supporting new-style classes, however it seems that real-world software seems to rely on them quite a bit, so we decided to offer a better migration path.

A while ago I therefore started a re-implementation of classic classes in RPython to speed them up. This work is now <a href="https://codespeak.net/viewvc/pypy/dist/pypy/module/__builtin__/interp_classobj.py?view=markup">finished</a>, the branch I worked on got merged today. Speed for the old-style class benchmarks was improved greatly and I found quite a number of bugs in the old implementation too. New-style classes are still a bit faster than old-style in PyPy though, and this is unlikely to change.</p>
    </div>
    </article><div class="comment-level comment-level-1">
      <div class="comment comment-2218876369836994628">
        <div class="comment-header">
          <a name="comment-2218876369836994628"></a>
            <span class="author">Michael Foord</span> wrote on <span class="date">2007-12-14 18:29</span>:
        </div>
        <div class="comment-content">
          <p>Hey guys - its great to hear so much about PyPy progress. Keep up the good work (coding *and* blogging of course).<br><br>Michael</p>
        </div>
      </div>
      <div class="comment comment-5882330656454220475">
        <div class="comment-header">
          <a name="comment-5882330656454220475"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2007-12-14 18:38</span>:
        </div>
        <div class="comment-content">
          <p>Hi Michael!<br><br>It seems we are slowly getting into this blogging thing. Good to hear that somebody is actually <i>reading</i> that stuff too :-).<br><br>Cheers,<br><br>Carl Friedrich</p>
        </div>
      </div>
      <div class="comment comment-5629874116995353165">
        <div class="comment-header">
          <a name="comment-5629874116995353165"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2007-12-15 01:05</span>:
        </div>
        <div class="comment-content">
          <p>Of course it is being read, more please :)!</p>
        </div>
      </div>
      <div class="comment comment-2197226850984314398">
        <div class="comment-header">
          <a name="comment-2197226850984314398"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2007-12-20 14:10</span>:
        </div>
        <div class="comment-content">
          <p>Dear Carl and other PyPy developers,<br>Thank you for all of your hard work in getting PyPy to its present impressive state. <br>I really enjoy reading about your activities and accomplishments on this blog and on the PyPy irc logs.<br><br>-gyro</p>
        </div>
      </div>
      <div class="comment comment-1464516953808437306">
        <div class="comment-header">
          <a name="comment-1464516953808437306"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2007-12-20 14:23</span>:
        </div>
        <div class="comment-content">
          <p>Hi gyro!<br><br>Really impressive that you chew through all the IRC-logs: Even I find that a lot of work sometimes :-)</p>
        </div>
      </div>
         </div>

    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/profiling-for-fun-with-valgrind-3215121784705288400.html" class="u-url">Profiling for fun with valgrind</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/maciej-fijalkowski.html">Maciej Fijalkowski</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/profiling-for-fun-with-valgrind-3215121784705288400.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-14T11:02:00Z" itemprop="datePublished" title="2007-12-14 11:02">2007-12-14 11:02</time></a>
            </p>
                <p class="commentline">4 comments</p>

        </div>
    </header><div class="p-summary entry-summary">
    <p>Recently I've been doing a lot of profiling on the PyPy executables to find speed bottlenecks. <a href="https://en.wikipedia.org/wiki/Valgrind">Valgrind</a> (the original <a href="https://valgrind.org/">page</a> seems to be down) is an extremely nice tool for doing this. It has several built-in tools that give you different types of profiles. The callgrind mode provides you with a lot of information including relative call costs. The cachegrind tool gives you less information, but what it gives you (e.g. cache misses) is much more accurate. The obvious choice would be to have a way to combine the results of two profiling runs to have both. In the last days I wrote a script that does this. It's available <a href="https://codespeak.net/svn/user/fijal/pygrind">at my user's svn</a> and has a pretty intuitive command line interface. The combining calculation are not perfect yet, total costs of functions can still be a bit bogus (they can sum up to whatever) but at least the relative figures are good. This means that we can stop looking at two different types of graphs now.

An awesome tool for analyzing the profile data is <a href="https://kcachegrind.sourceforge.net/cgi-bin/show.cgi">kcachegrind.</a>

<a href="https://4.bp.blogspot.com/_5R1EBmwBBTs/R2JjKRYuTTI/AAAAAAAAAAM/LX5ktu_FcIE/s1600-h/kcachegrind.png"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5143782752527469874" src="https://4.bp.blogspot.com/_5R1EBmwBBTs/R2JjKRYuTTI/AAAAAAAAAAM/LX5ktu_FcIE/s320/kcachegrind.png" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer;"></a>

Which also proves that my 12'' display is to small at least for some things :-).


<b>Update:</b> pygrind is available under the MIT license.</p>
    </div>
    </article><div class="comment-level comment-level-1">
      <div class="comment comment-977590604047837128">
        <div class="comment-header">
          <a name="comment-977590604047837128"></a>
            <span class="author">JosÃ© Fonseca</span> wrote on <span class="date">2007-12-14 13:11</span>:
        </div>
        <div class="comment-content">
          <p>Nice!<br><br>In what license are you releasing pygrind? I would like to integrate pygrind's code into <a href="https://code.google.com/p/jrfonseca/wiki/Gprof2Dot" rel="nofollow">Gprof2Dot</a> (LGPL) to be able to generate nice-looking graphs from cachegrind output.</p>
        </div>
      </div>
      <div class="comment comment-2262415208915431144">
        <div class="comment-header">
          <a name="comment-2262415208915431144"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2007-12-14 13:18</span>:
        </div>
        <div class="comment-content">
          <p>Indeed, good question, thanks. I've updated blog post (I think it satisfies you, if not you can have it under LGPL if you like).</p>
        </div>
      </div>
      <div class="comment comment-8192303769132431994">
        <div class="comment-header">
          <a name="comment-8192303769132431994"></a>
            <span class="author">JosÃ© Fonseca</span> wrote on <span class="date">2007-12-14 14:43</span>:
        </div>
        <div class="comment-content">
          <p>Excellent. Thanks!</p>
        </div>
      </div>
      <div class="comment comment-3560137603457065256">
        <div class="comment-header">
          <a name="comment-3560137603457065256"></a>
            <span class="author">Aaron Bentley</span> wrote on <span class="date">2007-12-14 17:57</span>:
        </div>
        <div class="comment-content">
          <p>If you like kcachegrind, you might like using it for profiling python:<br>https://ddaa.net/blog/python/lsprof-calltree</p>
        </div>
      </div>
         </div>

    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/pypy-talk-at-python-user-group-munich-1952379593354367249.html" class="u-url">PyPy Talk at the Python User Group Munich</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/pypy-talk-at-python-user-group-munich-1952379593354367249.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-12T23:10:00Z" itemprop="datePublished" title="2007-12-12 23:10">2007-12-12 23:10</time></a>
            </p>
            
        </div>
    </header><div class="p-summary entry-summary">
    <p>Tomorrow evening there will be an <a href="https://article.gmane.org/gmane.comp.python.general.german/6098">introductory talk</a> about PyPy at the <a href="https://wiki.python.de/User_Group_M%C3%BCnchen">Python User Group Munich</a>. The talk will be given by CPython and PyPy contributor Georg Brandl and will be in German.</p>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/pypy-tasks-in-ghop-5130253260153218709.html" class="u-url">PyPy tasks in GHOP</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/pypy-tasks-in-ghop-5130253260153218709.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-07T22:40:00Z" itemprop="datePublished" title="2007-12-07 22:40">2007-12-07 22:40</time></a>
            </p>
            
        </div>
    </header><div class="p-summary entry-summary">
    <p>In the latest bunch of tasks that Titus released on Friday for the <a href="https://code.google.com/opensource/ghop/2007-8/">Google Highly Open Participation Contest</a> there are several that are related to PyPy. Some of them are about presenting PyPy to a technical audience: <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=187">Task 187</a>, <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=188">Task 188</a>, <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=189">Task 189</a>, <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=190">Task 190</a>.

Then there are some three about Ropes, which are all rather challenging:
</p>
<ul>
<li>Solving the first three section of the last <a href="https://www.icfpcontest.org/">ICFP contest</a> with <a href="../posts/2007/11/ropes-branch-merged-8782576892496878598.html">PyPy's ropes implementation</a>:<a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=248">Task 248</a>.</li>
<li>Implementing nice wrapper classes around PyPy's <a href="https://codespeak.net/svn/pypy/dist/pypy/rlib/rope.py">ropes algorithms</a> to make their use convenient: <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=239">Task 239</a>.</li>
<li>Implementing the Ropes algorithms in C as a CPython extension module: <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=218">Task 218</a> (already taken).</li>
</ul>
In addition there is a task to use PyPy's <a href="https://codespeak.net/pypy/dist/pypy/doc/sandbox.html">sandboxing features</a> to provide an interactive Python tutorial on a web page: <a href="https://code.google.com/p/google-highly-open-participation-psf/issues/detail?id=220">Task 220</a>.

We're really looking forward to working together with some bright students!
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/faster-than-c-8057790636822502084.html" class="u-url">faster than c</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/faster-than-c-8057790636822502084.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-05T23:52:00Z" itemprop="datePublished" title="2007-12-05 23:52">2007-12-05 23:52</time></a>
            </p>
                <p class="commentline">5 comments</p>

        </div>
    </header><div class="p-summary entry-summary">
    <span style="font-style: italic;">Of course </span>being "faster than c" means being faster than light. What did you think it means? :-)
    </div>
    </article><div class="comment-level comment-level-1">
      <div class="comment comment-715947350982528280">
        <div class="comment-header">
          <a name="comment-715947350982528280"></a>
            <span class="author">teki</span> wrote on <span class="date">2007-12-06 01:28</span>:
        </div>
        <div class="comment-content">
          <p>"faster than c" means you can write code in other languages which look like do the same as the c one, but the c one is slower</p>
        </div>
      </div>
      <div class="comment comment-3579498789171779102">
        <div class="comment-header">
          <a name="comment-3579498789171779102"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2007-12-06 09:20</span>:
        </div>
        <div class="comment-content">
          <p>Took me some time to get the joke. =)</p>
        </div>
      </div>
      <div class="comment comment-8326420711233878210">
        <div class="comment-header">
          <a name="comment-8326420711233878210"></a>
            <span class="author">Fredrik Johansson</span> wrote on <span class="date">2007-12-06 16:48</span>:
        </div>
        <div class="comment-content">
          <p>Dream on; only imaginary things can be faster than c.<br><br>(Relativistic mass formula with square root of a negative number for those who don't get it.)</p>
        </div>
      </div>
      <div class="comment comment-6561696029347399988">
        <div class="comment-header">
          <a name="comment-6561696029347399988"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2007-12-06 17:09</span>:
        </div>
        <div class="comment-content">
          <p>Sorry, sorry. I think I spent too much time around physicists. Further hint: notice the lower-case c.</p>
        </div>
      </div>
      <div class="comment comment-2531259263028664841">
        <div class="comment-header">
          <a name="comment-2531259263028664841"></a>
            <span class="author">Eduardo O. Padoan</span> wrote on <span class="date">2007-12-18 16:06</span>:
        </div>
        <div class="comment-content">
          <p>Benchmarking is relative :)</p>
        </div>
      </div>
         </div>

    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="../posts/2007/12/good-news-from-garbage-collection-front-2678138026363485439.html" class="u-url">Good news from the garbage collection front</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                <a href="../authors/maciej-fijalkowski.html">Maciej Fijalkowski</a>
            </span></p>
            <p class="dateline">
            <a href="../posts/2007/12/good-news-from-garbage-collection-front-2678138026363485439.html" rel="bookmark">
            <time class="published dt-published" datetime="2007-12-05T21:35:00Z" itemprop="datePublished" title="2007-12-05 21:35">2007-12-05 21:35</time></a>
            </p>
            
        </div>
    </header><div class="p-summary entry-summary">
    <p>It seems that we can do better! Armin fixed a bug in our generational garbage collector, which caused variable sized objects (e.g. arrays) to be allocated outside  of the nursery. This resulted in 50% speedup on synthetic benchmarks and about 10-20% on real world ones. Doing some <b>preliminary</b> measures, it seems that we spend roughly 10% of the time in garbage collection, which is good (and there is still some room for improvements!)</p>
    </div>
    </article>
</div>
</div>
<div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2025/07/pypy-v7320-release.html" class="listtitle">PyPy v7.3.20 release</a>
      </li>
      <li>
        <a href="/posts/2025/06/rpython-gc-allocation-speed.html" class="listtitle">How fast can the RPython GC allocate?</a>
      </li>
      <li>
        <a href="/posts/2025/04/prospero-in-rpython.html" class="listtitle">Doing the Prospero-Challenge in RPython</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7319-release.html" class="listtitle">PyPy v7.3.19 release</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-gc-sampling.html" class="listtitle">Low Overhead Allocation Sampling with VMProf in PyPy's GC</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7318-release.html" class="listtitle">PyPy v7.3.18 release</a>
      </li>
      <li>
        <a href="/posts/2025/01/musings-tracing.html" class="listtitle">Musings on Tracing in PyPy</a>
      </li>
      <li>
        <a href="/posts/2025/01/towards-pypy311-an-update.html" class="listtitle">Towards PyPy3.11 - an update</a>
      </li>
      <li>
        <a href="/posts/2024/11/guest-post-final-encoding-in-rpython.html" class="listtitle">Guest Post: Final Encoding in RPython Interpreters</a>
      </li>
      <li>
        <a href="/posts/2024/10/jit-peephole-dsl.html" class="listtitle">A DSL for Peephole Transformation Rules of Integer Operations in the PyPy JIT</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
            <li><a class="reference" href="/2021/">2021</a> (10)
            </li>
            <li><a class="reference" href="/2022/">2022</a> (13)
            </li>
            <li><a class="reference" href="/2023/">2023</a> (6)
            </li>
            <li><a class="reference" href="/2024/">2024</a> (13)
            </li>
            <li><a class="reference" href="/2025/">2025</a> (8)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (2)</li>
            <li><a class="reference" href="/categories/benchmarking.html">benchmarking</a> (1)</li>
            <li><a class="reference" href="/categories/casestudy.html">casestudy</a> (3)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/conda-forge.html">conda-forge</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (4)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (3)</li>
            <li><a class="reference" href="/categories/gc.html">gc</a> (3)</li>
            <li><a class="reference" href="/categories/guestpost.html">guestpost</a> (3)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (23)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/meta.html">meta</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/performance.html">performance</a> (2)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (7)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (66)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (2)</li>
            <li><a class="reference" href="/categories/rpython.html">rpython</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (6)</li>
            <li><a class="reference" href="/categories/sponsors.html">sponsors</a> (7)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/sprints.html">sprints</a> (1)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/testing.html">testing</a> (1)</li>
            <li><a class="reference" href="/categories/toy-optimizer.html">toy-optimizer</a> (5)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
            <li><a class="reference" href="/categories/vmprof.html">vmprof</a> (3)</li>
            <li><a class="reference" href="/categories/z3.html">z3</a> (5)</li>
          </ul>
        </div></div>
</main>
</div>
<div style="clear: both; width: 75%; margin: 1em auto;">
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-3.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav>
</div>
         
                 <footer id="footer"><p>
</p>
<div class="myfooter">
  <div class="logotext">
    Â© 2025 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
    Â 
    Built with <a href="https://getnikola.com" rel="nofollow">Nikola</a>
    Â 
    Last built 2025-07-07T11:01
  </div>
  <div style="margin-left: auto">
  <a href="../rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../assets/js/styles.js"></script></footer>
</body>
</html>