<!DOCTYPE html>
<html \ prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Leysin Sprint Report | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2009/04/leysin-sprint-report-1416905818217912359.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
<meta name="author" content="Carl Friedrich Bolz-Tereick">
<link rel="prev" href="beta-for-110-released-4604559533184706699.html" title="Beta for 1.1.0 released" type="text/html">
<link rel="next" href="roadmap-for-jit-377358891902851723.html" title="Roadmap for JIT" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="Leysin Sprint Report">
<meta property="og:url" content="https://www.pypy.org/posts/2009/04/leysin-sprint-report-1416905818217912359.html">
<meta property="og:description" content="The Leysin sprint is nearing its end, as usual here is an attempt at a summary
of what we did.
Release Work
Large parts of the sprint were dedicated to fixing bugs. Since the easy bugs
seem to have be">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2009-04-21T15:47:00Z">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog/">Index</a> </li>  
                    <li> <a href="../../../categories/">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://bsky.app/profile/pypyproject.bsky.social">Bluesky</a> </li>  
                    <li> <a href="https://libera.irclog.whitequark.org/pypy">IRC logs</a> </li>  
                    <li> <a href="https://www.youtube.com/playlist?list=PLADqad94yVqDRQXuqxKrPS5QnVqbDLlRt">YouTube</a> </li>  
                    <li> <a href="https://www.twitch.tv/pypyproject">Twitch</a> </li>  
                    <li> <a href="../../../pypy-sponsors.html">Sponsors</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section><div class="searchform" role="search">
                
<form class="navbar-form navbar-left" action="../../../search.html" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search…" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;">
</form>

            </div>
    </header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Leysin Sprint Report</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../authors/carl-friedrich-bolz-tereick.html">Carl Friedrich Bolz-Tereick</a>
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2009-04-21T15:47:00Z" itemprop="datePublished" title="2009-04-21 15:47">2009-04-21 15:47</time></a>
            </p>
                <p class="commentline">2 comments</p>

                <p class="commentline">            <a href="leysin-sprint-report-1416905818217912359.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <p>The Leysin sprint is nearing its end, as usual here is an attempt at a summary
</p>
<p>of what we did.</p>
<a href="https://4.bp.blogspot.com/_zICyAWqZbLA/Se3dHMjUvrI/AAAAAAAAAHk/ZwGu2owTSok/s1600-h/landscape.jpg"><img alt="Beautiful Leysin Landscape" border="0" id="BLOGGER_PHOTO_ID_5327157049947373234" src="https://4.bp.blogspot.com/_zICyAWqZbLA/Se3dHMjUvrI/AAAAAAAAAHk/ZwGu2owTSok/s320/landscape.jpg" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 213px;"></a><div class="section" id="release-work">
<h2>Release Work<a href="#release-work" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p>Large parts of the sprint were dedicated to fixing bugs. Since the easy bugs
seem to have been fixed long ago, those were mostly very annoying and hard bugs.
This work was supported by our <a class="reference external" href="https://codespeak.net:8099/">buildbots</a>, which we tried to get free of
test-failures. This was worked on by nearly all participants of the sprint
(Samuele, Armin, Anto, Niko, Anders, Christian, Carl Friedrich). One
particularly annoying bug was the differences in the tracing events that PyPy
produces (fixed by Anders, Samuele and Christian). Some details about larger
tasks are in the sections below.</p>
<p>The work culminated in the <a class="reference external" href="beta-for-110-released-4604559533184706699.html">beta</a> released on Sunday.</p>
<div class="section" id="stackless">
<h3>Stackless<a href="#stackless" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>A large number of problems came from our <a class="reference external" href="https://codespeak.net/pypy/dist/pypy/doc/stackless.html">stackless features</a>, which do some
advanced things and thus seem to contain advanced bugs. Samuele and Carl
Friedrich spent some time fixing tasklet pickling and unpickling. This was
achieved by supporting the (un)pickling of builtin code objects. In addition
they fixed some bugs in the finalization of tasklets. This needs some care
because the <tt class="docutils literal"><span class="pre">__del__</span></tt> of a tasklet cannot run at arbitrary points in time, but
only at safe points. This problem was a bit subtle to get right, and popped up
nearly every morning of the sprint in form of a test failure.</p>
<p>Armin and Niko added a way to restrict the stack depth of the RPython-level
stack. This can useful when using stackless, because if this is not there it is
possible that you fill your whole heap with stack frames in the case of an
infinite recursion. Then they went on to make stackless not segfault when
threads are used at the same time, or if a callback from C library code is in
progress. Instead you get a <tt class="docutils literal"><span class="pre">RuntimeError</span></tt> now, which is not good but better
than a segfault.</p>
</div>
<a href="https://2.bp.blogspot.com/_zICyAWqZbLA/Se3dbHpy8xI/AAAAAAAAAH0/7rgKpUQhFVA/s1600-h/pair2.jpg"><img alt="Anto and Armin working on the JIT" border="0" id="BLOGGER_PHOTO_ID_5327157392229724946" src="https://2.bp.blogspot.com/_zICyAWqZbLA/Se3dbHpy8xI/AAAAAAAAAH0/7rgKpUQhFVA/s320/pair2.jpg" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 213px;"></a>
<a href="https://1.bp.blogspot.com/_zICyAWqZbLA/Se3dazWieiI/AAAAAAAAAHs/JeahZb31xyg/s1600-h/pair1.jpg">
</a><div class="section" id="killing-features">
<h3>Killing Features<a href="#killing-features" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>During the sprint we discussed the fate of the LLVM and the JS backends. Both
have not really been maintained for some time, and even partially untested
(their tests were skipped). Also their usefulness appears to be limited. The JS
backend is cool in principle, but has some serious limitations due to the fact
that JavaScript is really a dynamic language, while RPython is rather static.
This made it hard to use some features of JS from RPython, e.g. RPython does not
support closures of any kind.</p>
<p>The LLVM backend had its own set of problems. For
a long time it produced the fastest form of PyPy's Python interpreter, by first
using the LLVM backend, applying the LLVM optimizations to the result, then
using LLVM's C backend to produce C code, then apply GCC to the result :-).
However, it is not clear that it is still useful to directly produce LLVM
bitcode, since LLVM has rather good C frontends nowadays, with <a class="reference external" href="https://llvm.org/cmds/llvmgcc.html">llvm-gcc</a> and
<a class="reference external" href="https://clang.llvm.org/">clang</a>. It is likely that we will use LLVM in the future in our JIT (but that's
another story, based on different code).</p>
<p>Therefore we decided to remove these two backends from SVN, which Samuele and
Carl Friedrich did. They are not dead, only resting until somebody who is
interested in maintaining them steps up.</p>
</div>
<div class="section" id="windows">
<h3>Windows<a href="#windows" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>One goal of the release is good Windows-support. Anders and Samuele set up a new
<a class="reference external" href="https://codespeak.net:8099/builders/pypy-c-lib-python-win-32">windows buildbot</a> which revealed a number of failures. Those were attacked by
Anders, Samuele and Christian as well as by Amaury (who was not at the sprint,
but thankfully did a lot of Windows work in the last months).</p>
</div>
<div class="section" id="os-x">
<h3>OS X<a href="#os-x" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Christian with some help by Samuele tried to get translation working again under
Mac OS X. This was a large mess, because of different behaviours of some POSIX
functionality in Leopard. It is still possible to get the old behaviour back,
but whether that was enabled or not depended on a number of factors such as
which Python is used. Eventually they managed to successfully navigate that maze
and produce something that almost works (there is still a problem remaining
about OpenSSL).</p>
</div>
<a href="https://1.bp.blogspot.com/_zICyAWqZbLA/Se3dazWieiI/AAAAAAAAAHs/JeahZb31xyg/s1600-h/pair1.jpg"><img alt="Samuele and Carl Friedrich pretending to work on something" border="0" id="BLOGGER_PHOTO_ID_5327157386780244514" src="https://1.bp.blogspot.com/_zICyAWqZbLA/Se3dazWieiI/AAAAAAAAAHs/JeahZb31xyg/s320/pair1.jpg" style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 213px;"></a>
<div class="section" id="documentation">
<h3>Documentation<a href="#documentation" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>The Friday of the sprint was declared to be a documentation day, where (nearly)
no coding was allowed. This resulted in a newly structured and improved <a class="reference external" href="https://codespeak.net/pypy/dist/pypy/doc/getting-started.html">getting
started</a> document (done by Carl Friedrich, Samuele and some help of Niko) and
a new document describing <a class="reference external" href="https://codespeak.net/pypy/dist/pypy/doc/cpython_differences.html">differences to CPython</a> (Armin, Carl Friedrich) as
well as various improvements to existing documents (everybody else). Armin
undertook the Sisyphean task of <a class="reference external" href="https://codespeak.net/pypy/dist/pypy/doc/extradoc.html">listing all talks, paper and related stuff</a>
of the PyPy project.</p>
</div>
</div>
<div class="section" id="various-stuff">
<h2>Various Stuff<a href="#various-stuff" class="headerlink" title="Permalink to this heading">¶</a></h2>
<div class="section" id="java-backend-work">
<h3>Java Backend Work<a href="#java-backend-work" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Niko and Anto worked on the JVM backend for a while. First they had to fix
translation of the Python interpreter to Java. Then they tried to improve the
performance of the Python interpreter when translated to Java. Mostly they did a
lot of profiling to find performance bottlenecks. They managed to improve
performance by 40% by overriding <tt class="docutils literal"><span class="pre">fillInStackTrace</span></tt> of the generated exception
classes. Apart from that they found no simple-to-fix performance problems.</p>
</div>
<div class="section" id="jit-work">
<h3>JIT Work<a href="#jit-work" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Armin gave a presentation about the current state of the JIT to the sprinters as
well as Adrian Kuhn, Toon Verwaest and Camillo Bruni of the University of Bern
who came to visit for one day. There was a bit of work on the JIT going on too;
Armin and Anto tried to get closer to having a working JIT on top of the CLI.</p>
</div>
</div>
      </div>
      <aside class="postpromonav"><nav><ul class="pager hidden-print">
<li class="previous">
                <a href="beta-for-110-released-4604559533184706699.html" rel="prev" title="Beta for 1.1.0 released">Previous post</a>
            </li>
            <li class="next">
                <a href="roadmap-for-jit-377358891902851723.html" rel="next" title="Roadmap for JIT">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-4120489951991164265">
        <div class="comment-header">
          <a name="comment-4120489951991164265"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2009-04-22 07:46</span>:
        </div>
        <div class="comment-content">
          <p>Guys, are you going to make a new release with the things done during the sprint? Thanks.<br><br>(pypy is a great work; Keep it up!)</p>
        </div>
      </div>
      <div class="comment comment-8300696998408449990">
        <div class="comment-header">
          <a name="comment-8300696998408449990"></a>
            <span class="author">vak</span> wrote on <span class="date">2009-11-03 12:30</span>:
        </div>
        <div class="comment-content">
          <p>hi, <br>could you please make a new blog-post and tell us about news regarding LLVM and PyPy, please?<br><br>thanks in advance!</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2025/07/pypy-v7320-release.html" class="listtitle">PyPy v7.3.20 release</a>
      </li>
      <li>
        <a href="/posts/2025/06/rpython-gc-allocation-speed.html" class="listtitle">How fast can the RPython GC allocate?</a>
      </li>
      <li>
        <a href="/posts/2025/04/prospero-in-rpython.html" class="listtitle">Doing the Prospero-Challenge in RPython</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7319-release.html" class="listtitle">PyPy v7.3.19 release</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-gc-sampling.html" class="listtitle">Low Overhead Allocation Sampling with VMProf in PyPy's GC</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7318-release.html" class="listtitle">PyPy v7.3.18 release</a>
      </li>
      <li>
        <a href="/posts/2025/01/musings-tracing.html" class="listtitle">Musings on Tracing in PyPy</a>
      </li>
      <li>
        <a href="/posts/2025/01/towards-pypy311-an-update.html" class="listtitle">Towards PyPy3.11 - an update</a>
      </li>
      <li>
        <a href="/posts/2024/11/guest-post-final-encoding-in-rpython.html" class="listtitle">Guest Post: Final Encoding in RPython Interpreters</a>
      </li>
      <li>
        <a href="/posts/2024/10/jit-peephole-dsl.html" class="listtitle">A DSL for Peephole Transformation Rules of Integer Operations in the PyPy JIT</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
            <li><a class="reference" href="/2021/">2021</a> (10)
            </li>
            <li><a class="reference" href="/2022/">2022</a> (13)
            </li>
            <li><a class="reference" href="/2023/">2023</a> (6)
            </li>
            <li><a class="reference" href="/2024/">2024</a> (13)
            </li>
            <li><a class="reference" href="/2025/">2025</a> (8)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (2)</li>
            <li><a class="reference" href="/categories/benchmarking.html">benchmarking</a> (1)</li>
            <li><a class="reference" href="/categories/casestudy.html">casestudy</a> (3)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/conda-forge.html">conda-forge</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (4)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (3)</li>
            <li><a class="reference" href="/categories/gc.html">gc</a> (3)</li>
            <li><a class="reference" href="/categories/guestpost.html">guestpost</a> (3)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (23)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/meta.html">meta</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/performance.html">performance</a> (2)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (7)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (66)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (2)</li>
            <li><a class="reference" href="/categories/rpython.html">rpython</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (6)</li>
            <li><a class="reference" href="/categories/sponsors.html">sponsors</a> (7)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/sprints.html">sprints</a> (1)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/testing.html">testing</a> (1)</li>
            <li><a class="reference" href="/categories/toy-optimizer.html">toy-optimizer</a> (5)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
            <li><a class="reference" href="/categories/vmprof.html">vmprof</a> (3)</li>
            <li><a class="reference" href="/categories/z3.html">z3</a> (5)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div class="logotext">
    © 2025 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
     
    Built with <a href="https://getnikola.com" rel="nofollow">Nikola</a>
     
    Last built 2025-07-07T11:01
  </div>
  <div style="margin-left: auto">
  <a href="../../../rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>