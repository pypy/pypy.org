<!DOCTYPE html>
<html \ prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PyPy-STM 2.5.1 released | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2015/03/pypy-stm-251-released-1342113838236225773.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
<meta name="author" content="Armin Rigo">
<link rel="prev" href="pypy-251-released-5657064769385723517.html" title="PyPy 2.5.1 Released" type="text/html">
<link rel="next" href="../05/cffi-10-beta-1-4375652711495636911.html" title="CFFI 1.0 beta 1" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="PyPy-STM 2.5.1 released">
<meta property="og:url" content="https://www.pypy.org/posts/2015/03/pypy-stm-251-released-1342113838236225773.html">
<meta property="og:description" content="PyPy-STM 2.5.1 - Mawhrin-Skel

We're pleased to announce PyPy-STM 2.5.1, codenamed Mawhrin-Skel.
This is the second official release of PyPy-STM.  You can download
this release here (64-bit Linux only">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-03-30T16:10:00Z">
<meta property="article:tag" content="release">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog/">Index</a> </li>  
                    <li> <a href="../../../categories/">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://bsky.app/profile/pypyproject.bsky.social">Bluesky</a> </li>  
                    <li> <a href="https://libera.irclog.whitequark.org/pypy">IRC logs</a> </li>  
                    <li> <a href="https://www.youtube.com/playlist?list=PLADqad94yVqDRQXuqxKrPS5QnVqbDLlRt">YouTube</a> </li>  
                    <li> <a href="https://www.twitch.tv/pypyproject">Twitch</a> </li>  
                    <li> <a href="../../../pypy-sponsors.html">Sponsors</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section><div class="searchform" role="search">
                
<form class="navbar-form navbar-left" action="../../../search.html" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search…" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;">
</form>

            </div>
    </header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">PyPy-STM 2.5.1 released</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../authors/armin-rigo.html">Armin Rigo</a>
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2015-03-30T16:10:00Z" itemprop="datePublished" title="2015-03-30 16:10">2015-03-30 16:10</time></a>
            </p>
                <p class="commentline">6 comments</p>

                <p class="commentline">            <a href="pypy-stm-251-released-1342113838236225773.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <h2 class="title" id="pypy-stm-251-mawhrin-skel">PyPy-STM 2.5.1 - Mawhrin-Skel<a href="#pypy-stm-251-mawhrin-skel" class="headerlink" title="Permalink to this heading">¶</a></h2>

<p>We're pleased to announce PyPy-STM 2.5.1, codenamed Mawhrin-Skel.
This is the second official release of PyPy-STM.  You can download
this release here (64-bit Linux only):</p>
<blockquote>
<a class="reference external" href="https://pypy.org/download.html">https://pypy.org/download.html</a>
</blockquote>
<p>Documentation:</p>
<blockquote>
<a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html">https://pypy.readthedocs.org/en/latest/stm.html</a>
</blockquote>
<p>PyPy is an implementation of the Python programming language which focuses
on performance. So far we've been relentlessly optimizing for the single
core/process scenario. PyPy STM brings to the table a version of PyPy
that does not have the infamous Global Interpreter Lock, hence can run
multiple threads on multiple cores. Additionally it comes with a set
of primitives that make writing multithreaded applications a lot easier,
as explained below (see TransactionQueue) and in the documentation.</p>
<p>Internally, PyPy-STM is based on the Software Transactional Memory
plug-in called stmgc-c7.  This version comes with a relatively
reasonable single-core overhead but scales only up to around 4 cores
on some examples; the next version of the plug-in, stmgc-c8, is in
development and should address that limitation (as well as reduce the
overhead).  These versions only support 64-bit Linux; we'd welcome
someone to port the upcoming stmgc-c8 to other (64-bit) platforms.</p>
<p>This release passes all regular PyPy tests, except for a few
special cases.  In other words, you should be able to drop in
PyPy-STM instead of the regular PyPy and your program should still
work.  See <a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html#current-status-stmgc-c7">current status</a> for more information.</p>
<p>This work was done by Remi Meier and Armin Rigo.  Thanks to all donors
for <a class="reference external" href="https://pypy.org/tmdonate2.html">crowd-funding the STM work</a> so far!  As usual, it took longer
than we would have thought.  I really want to thank the people that
kept making donations anyway.  Your trust is greatly appreciated!</p>
<br><div class="section" id="what-s-new">
<h2>What's new?<a href="#what-s-new" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p>Compared to the <a class="reference external" href="../../2014/07/pypy-stm-first-interesting-release-8684276541915333814.html">July 2014 release</a>, the main addition is a way to
get reports about STM conflicts.  This is an essential new feature.</p>
<p>To understand why this is so important, consider that if you already
played around with the previous release, chances are that you didn't
get very far.  It probably felt like a toy: on very small examples it
would nicely scale, but on any larger example it would not scale at
all.  You didn't get any feedback about why, but the underlying reason
is that, in a typical large example, there are some STM conflicts that
occur all the time and that won't be immediately found just by
thinking.  This prevents any parallelization.</p>
<p>Now PyPy-STM is no longer a black box: you have a way to learn about
these conflicts, fix them, and try again.  The tl;dr version is to run:</p>
<pre class="literal-block">
    PYPYSTM=stmlog ./pypy-stm example.py
    ./print_stm_log.py stmlog
</pre>
<p>More details in <a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html#user-guide">the STM user guide</a>.</p>
</div>
<br><div class="section" id="performance">
<h2>Performance<a href="#performance" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p>The performance is now more stable than it used to be.  More
precisely, the best case is still "25%-40% single-core slow-down with
very good scaling up to 4 threads", but the average performance seems
not too far from that.  There are still dark spots --- notably, the
JIT is still slower to warm up, though it was improved a lot.  These
are documented in the <a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html#current-status-stmgc-c7">current status</a> section.  Apart from
that, we should not get more than 2x single-core slow-down in the
worst case.  Please report such cases as bugs!</p>
</div>
<br><div class="section" id="transactionqueue">
<h2>TransactionQueue<a href="#transactionqueue" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p>As explained before, PyPy-STM is more than "just" a Python without
GIL.  It is a Python in which you can do minor tweaks to your
existing, <em>non-multithreaded</em> programs and get them to use multiple
cores.  You identify medium- or large-sized, likely-independent parts
of the code and to ask PyPy-STM to run these parts in parallel.  An
example would be every iteration of some outermost loop over all items
of a dictionary.  This is done with a new API:
<tt class="docutils literal">transaction.TransactionQueue()</tt>.  See <tt class="docutils literal">help(TransactionQueue)</tt> or
read more about it in <a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html#user-guide">the STM user guide</a>.</p>
<p>This is not a 100% mechanical change: very likely, you need to hunt
for and fix "STM conflicts" that prevent parallel execution (see
<a class="reference external" href="https://pypy.readthedocs.org/en/latest/stm.html#transaction-transactionqueue">docs</a>).  However, at all points your program runs correctly, and you
can stop the hunt when you get acceptable performance.  You don't get
deadlocks or corrupted state.</p>
</div>
<i></i><p>Thanks for reading!<br>
Armin, Remi, Fijal</p>
      </div>
      <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/release.html" rel="tag">release</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="pypy-251-released-5657064769385723517.html" rel="prev" title="PyPy 2.5.1 Released">Previous post</a>
            </li>
            <li class="next">
                <a href="../05/cffi-10-beta-1-4375652711495636911.html" rel="next" title="CFFI 1.0 beta 1">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-1675406256288212006">
        <div class="comment-header">
          <a name="comment-1675406256288212006"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2015-03-31 09:45</span>:
        </div>
        <div class="comment-content">
          <p>From your explanation in this post, STM sounds similar to OpenMP. Can you explain the differences?<br><br>→ https://openmp.org/wp/openmp-specifications/</p>
        </div>
      </div>
      <div class="comment comment-7832060604560329376">
        <div class="comment-header">
          <a name="comment-7832060604560329376"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2015-03-31 10:20</span>:
        </div>
        <div class="comment-content">
          <p>This is explained in https://pypy.readthedocs.org/en/latest/stm.html#how-to-write-multithreaded-programs-the-10-000-feet-view</p>
        </div>
      </div>
      <div class="comment comment-4675537695460074362">
        <div class="comment-header">
          <a name="comment-4675537695460074362"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2015-03-31 15:14</span>:
        </div>
        <div class="comment-content">
          <p>Nice - thanks!<br><br>»TransactionQueue is in part similar: your program needs to have “some chances” of parallelization before you can apply it. But I believe that the scope of applicability is much larger with TransactionQueue than with other approaches. It usually works without forcing a complete reorganization of your existing code, and it works on any Python program which has got latent and imperfect parallelism. Ideally, it only requires that the end programmer identifies where this parallelism is likely to be found«<br><br>If I understand that correctly, for STM the parallelism only needs to be <b>likely</b> and can be <b>imperfect</b>, because it can recover from errors.<br><br>This would fix a whole class of problems I experienced in OpenMP Fortran code: Turning a crash or (worse) undefined behavior into a mere performance loss - and that’s really cool!<br><br>Thank you for working on that!</p>
        </div>
      </div>
      <div class="comment comment-9015646929928189615">
        <div class="comment-header">
          <a name="comment-9015646929928189615"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2015-04-23 13:07</span>:
        </div>
        <div class="comment-content">
          <p>Why do you always ask for money if nothing actually works?</p>
        </div>
      </div>
      <div class="comment comment-7637389952394259059">
        <div class="comment-header">
          <a name="comment-7637389952394259059"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2015-04-23 15:17</span>:
        </div>
        <div class="comment-content">
          <p>the alternative is to ask for money for stuff that already works, and that's a terrible strategy. suggest better alternatives</p>
        </div>
      </div>
      <div class="comment comment-8813475604335825911">
        <div class="comment-header">
          <a name="comment-8813475604335825911"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2015-04-24 00:53</span>:
        </div>
        <div class="comment-content">
          <p>Your comment suggests PyPy-STM doesn't actually work for you.  If you have found a bug, please contribute a bug report, even if only if you have an example of program that should parallelize and doesn't; such bug reports are very useful.  Alternatively, you're complaining that PyPy-STM is useless for you.  Maybe I've been bad at explaining what you should expect and not expect from it in the first place, so I've given you wrong expectations.  In that case, sorry.  (The 3rd alternative would be that you're just trolling, but let's discard it for now.)</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2025/12/toy-load-store.html" class="listtitle">Load and store forwarding in the Toy Optimizer</a>
      </li>
      <li>
        <a href="/posts/2025/07/pypy-v7320-release.html" class="listtitle">PyPy v7.3.20 release</a>
      </li>
      <li>
        <a href="/posts/2025/06/rpython-gc-allocation-speed.html" class="listtitle">How fast can the RPython GC allocate?</a>
      </li>
      <li>
        <a href="/posts/2025/04/prospero-in-rpython.html" class="listtitle">Doing the Prospero-Challenge in RPython</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7319-release.html" class="listtitle">PyPy v7.3.19 release</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-gc-sampling.html" class="listtitle">Low Overhead Allocation Sampling with VMProf in PyPy's GC</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7318-release.html" class="listtitle">PyPy v7.3.18 release</a>
      </li>
      <li>
        <a href="/posts/2025/01/musings-tracing.html" class="listtitle">Musings on Tracing in PyPy</a>
      </li>
      <li>
        <a href="/posts/2025/01/towards-pypy311-an-update.html" class="listtitle">Towards PyPy3.11 - an update</a>
      </li>
      <li>
        <a href="/posts/2024/11/guest-post-final-encoding-in-rpython.html" class="listtitle">Guest Post: Final Encoding in RPython Interpreters</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
            <li><a class="reference" href="/2021/">2021</a> (10)
            </li>
            <li><a class="reference" href="/2022/">2022</a> (13)
            </li>
            <li><a class="reference" href="/2023/">2023</a> (6)
            </li>
            <li><a class="reference" href="/2024/">2024</a> (13)
            </li>
            <li><a class="reference" href="/2025/">2025</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (2)</li>
            <li><a class="reference" href="/categories/benchmarking.html">benchmarking</a> (1)</li>
            <li><a class="reference" href="/categories/casestudy.html">casestudy</a> (3)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/conda-forge.html">conda-forge</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (4)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (3)</li>
            <li><a class="reference" href="/categories/gc.html">gc</a> (3)</li>
            <li><a class="reference" href="/categories/guestpost.html">guestpost</a> (3)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (23)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/meta.html">meta</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/performance.html">performance</a> (2)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (7)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (66)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (2)</li>
            <li><a class="reference" href="/categories/rpython.html">rpython</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (6)</li>
            <li><a class="reference" href="/categories/sponsors.html">sponsors</a> (7)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/sprints.html">sprints</a> (1)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/testing.html">testing</a> (1)</li>
            <li><a class="reference" href="/categories/toy-optimizer.html">toy-optimizer</a> (6)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
            <li><a class="reference" href="/categories/vmprof.html">vmprof</a> (3)</li>
            <li><a class="reference" href="/categories/z3.html">z3</a> (5)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div class="logotext">
    © 2026 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
     
    Built with <a href="https://getnikola.com" rel="nofollow">Nikola</a>
     
    Last built 2026-01-17T00:22
  </div>
  <div style="margin-left: auto">
  <a href="../../../rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>