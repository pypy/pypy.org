<!DOCTYPE html>
<html \ prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PyPy 4.0.0 Released - A Jit with SIMD Vectorization and More | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2015/10/pypy-400-released-jit-with-simd-8282134928733384063.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
<meta name="author" content="mattip">
<link rel="prev" href="automatic-simd-vectorization-support-in-639063580401330508.html" title="Automatic SIMD vectorization support in PyPy" type="text/html">
<link rel="next" href="../11/pypy-401-released-please-update-2652340737298251005.html" title="PyPy 4.0.1 released please update" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="PyPy 4.0.0 Released - A Jit with SIMD Vectorization and More">
<meta property="og:url" content="https://www.pypy.org/posts/2015/10/pypy-400-released-jit-with-simd-8282134928733384063.html">
<meta property="og:description" content="PyPy 4.0.0
We’re pleased and proud to unleash PyPy 4.0.0, a major update of the PyPy python 2.7.10 compatible interpreter with a Just In Time compiler. We have improved warmup time and memory overhead">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2015-10-29T12:17:00Z">
<meta property="article:tag" content="release">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog/">Index</a> </li>  
                    <li> <a href="../../../categories/">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://bsky.app/profile/pypyproject.bsky.social">Bluesky</a> </li>  
                    <li> <a href="https://libera.irclog.whitequark.org/pypy">IRC logs</a> </li>  
                    <li> <a href="https://www.youtube.com/playlist?list=PLADqad94yVqDRQXuqxKrPS5QnVqbDLlRt">YouTube</a> </li>  
                    <li> <a href="https://www.twitch.tv/pypyproject">Twitch</a> </li>  
                    <li> <a href="../../../pypy-sponsors.html">Sponsors</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section><div class="searchform" role="search">
                
<form class="navbar-form navbar-left" action="../../../search.html" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search…" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;">
</form>

            </div>
    </header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">PyPy 4.0.0 Released - A Jit with SIMD Vectorization and More</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../authors/mattip.html">mattip</a>
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2015-10-29T12:17:00Z" itemprop="datePublished" title="2015-10-29 12:17">2015-10-29 12:17</time></a>
            </p>
                <p class="commentline">19 comments</p>

                <p class="commentline">            <a href="pypy-400-released-jit-with-simd-8282134928733384063.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <div dir="ltr" style="text-align: left;">
<h1 id="pypy-400">
PyPy 4.0.0<a href="#pypy-400" class="headerlink" title="Permalink to this heading">¶</a></h1>
We’re pleased and proud to unleash PyPy 4.0.0, a major update of the PyPy python 2.7.10 compatible interpreter with a Just In Time compiler. We have improved <a class="reference external" href="pypy-memory-and-warmup-improvements-2-4598780879518640015.html">warmup time and memory overhead used for tracing</a>, added <a class="reference external" href="https://pypyvecopt.blogspot.co.at/">vectorization</a> for numpy and general loops where possible on x86 hardware (disabled by default), refactored rough edges in rpython, and increased functionality of numpy.<br>
You can download the PyPy 4.0.0 release here:<br><blockquote>
<div>
<a class="reference external" href="https://pypy.org/download.html">https://pypy.org/download.html</a>
</div>
</blockquote>
We would like to thank our donors for the continued support of the PyPy project.<br>
We would also like to thank our contributors (7 new ones since PyPy 2.6.0) and encourage new people to join the project. PyPy has many layers and we need help with all of them: <a class="reference external" href="https://doc.pypy.org/">PyPy</a> and <a class="reference external" href="https://rpython.readthedocs.org/">RPython</a> documentation improvements, tweaking popular <a class="reference external" href="https://doc.pypy.org/en/latest/project-ideas.html#make-more-python-modules-pypy-friendly">modules</a> to run on PyPy, or general <a class="reference external" href="https://doc.pypy.org/en/latest/project-ideas.html">help</a> with making RPython’s JIT even better.<br><br><h3 style="text-align: center;" id="new-version-numbering">
New Version Numbering<a href="#new-version-numbering" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br><div class="section" id="new-version-numbering">
Since the past release, PyPy 2.6.1, we decided to update the PyPy 2.x.x versioning directly to PyPy 4.x.x, to avoid confusion with CPython 2.7 and 3.5. Note that this version of PyPy uses the stdlib and implements the syntax of CPython 2.7.10.</div>
<br><h3 style="text-align: center;" id="vectorization">
Vectorization<a href="#vectorization" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br><div class="section" id="vectorization">
Richard Plangger began work in March and continued over a Google Summer of Code to add a<a href="https://pypyvecopt.blogspot.co.at/"> <cite>vectorization</cite></a> step to the trace optimizer. The step recognizes common constructs and emits SIMD code where possible, much as any modern compiler does. This vectorization happens while tracing running code,  so it is actually easier at run-time to determine the availability of possible vectorization than it is for ahead-of-time compilers.<br>
Availability of SIMD hardware is detected at run time, without needing to precompile various code paths into the executable.<br>
The first version of the vectorization has been merged in this release, since it is so new it is off by default. To enable the vectorization in built-in JIT drivers (like numpy ufuncs), add <cite>–jit vec=1</cite>, to enable all implemented vectorization add <cite>–jit vec_all=1</cite><br>
Benchmarks and a summary of this work appear <a class="reference external" href="automatic-simd-vectorization-support-in-639063580401330508.html">here</a>
</div>
<br><h3 style="text-align: center;" id="internal-refactoring-warmup-time-improvement-and-reduced-memory-usage">
Internal Refactoring: Warmup Time Improvement and Reduced Memory Usage<a href="#internal-refactoring-warmup-time-improvement-and-reduced-memory-usage" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br><div class="section" id="internal-refactoring-and-warmup-time-improvement">
Maciej Fijalkowski and Armin Rigo refactored internals of <cite></cite>Rpython that now allow PyPy to more efficiently use <a class="reference external" href="https://rpython.readthedocs.org/en/latest/glossary.html">guards</a> in jitted code. They also rewrote unrolling, leading to a warmup time improvement of 20% or so. The reduction in guards also means a reduction in the use of memory, also a savings of around 20%.</div>
<div class="section" id="numpy">
<br><h3 style="text-align: center;">
Numpy<a href="#numpy" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br>
Our implementation of <a class="reference external" href="https://bitbucket.org/pypy/numpy">numpy</a> continues to improve. ndarray and the numeric dtypes are very close to feature-complete; record, string and unicode dtypes are mostly supported.  We have reimplemented numpy linalg, random and fft as cffi-1.0 modules that call out to the same underlying libraries that upstream numpy uses. Please try it out, especially using the new vectorization (via <cite>–jit vec=1</cite> on the command line) and let us know what is missing for your code.</div>
<div class="section" id="cffi">
<br><h3 style="text-align: center;">
CFFI<a href="#cffi" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br>
While not applicable only to PyPy, <a class="reference external" href="https://cffi.readthedocs.org/">cffi</a> is arguably our most significant contribution to the python ecosystem. Armin Rigo continued improving it, and PyPy reaps the benefits of <a class="reference external" href="https://cffi.readthedocs.org/en/latest/whatsnew.html#v1-3-0">cffi-1.3</a>: improved manangement of object lifetimes, __stdcall on Win32, ffi.memmove(), and percolate <code class="docutils literal"><span class="pre">const</span></code>, <code class="docutils literal"><span class="pre">restrict</span></code> keywords from cdef to C code.</div>
<div class="section" id="what-is-pypy">
<br><h3 style="text-align: center;">
What is PyPy?<a href="#what-is-pypy" class="headerlink" title="Permalink to this heading">¶</a></h3>
<br>
PyPy is a very compliant Python interpreter, almost a drop-in replacement for CPython 2.7. It’s fast (<a class="reference external" href="https://speed.pypy.org/">pypy and cpython 2.7.x</a> performance comparison) due to its integrated tracing JIT compiler.<br>
We also welcome developers of other <a class="reference external" href="https://pypyjs.org/">dynamic languages</a> to see what RPython can do for them.<br>
This release supports <b>x86</b> machines on most common operating systems (Linux 32/64, Mac OS X 64, Windows 32, <a class="reference external" href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/ports/lang/pypy">OpenBSD</a>, <a class="reference external" href="https://svnweb.freebsd.org/ports/head/lang/pypy/">freebsd</a>), as well as newer <b>ARM</b> hardware (ARMv6 or ARMv7, with VFPv3) running Linux.<br>
We also introduce <a class="reference external" href="powerpc-backend-for-jit-3014100267884692148.html">support for the 64 bit PowerPC</a> hardware, specifically Linux running the big- and little-endian variants of ppc64.</div>
<div class="section" id="other-highlights-since-2-6-1-release-two-months-ago">
<h3 style="text-align: center;">
Other Highlights (since 2.6.1 release two months ago)<a href="#other-highlights-since-2-6-1-release-two-months-ago" class="headerlink" title="Permalink to this heading">¶</a></h3>
<ul class="simple" style="text-align: left;">
<li>
<b>Bug Fixes</b><ul>
<li>Applied OPENBSD downstream fixes</li>
<li>Fix a crash on non-linux when running more than 20 threads</li>
<li>In cffi, ffi.new_handle() is more cpython compliant</li>
<li>Accept unicode in functions inside the _curses cffi backend exactly like cpython</li>
<li>Fix a segfault in itertools.islice()</li>
<li>Use gcrootfinder=shadowstack by default, asmgcc on linux only</li>
<li>Fix ndarray.copy() for upstream compatability when copying non-contiguous arrays</li>
<li>Fix assumption that lltype.UniChar is unsigned</li>
<li>Fix a subtle bug with stacklets on shadowstack</li>
<li>Improve support for the cpython capi in cpyext (our capi compatibility layer). Fixing these issues inspired some thought about cpyext in general, stay tuned for more improvements</li>
<li>When loading dynamic libraries, in case of a certain loading error, retry loading the library assuming it is actually a linker script, like on Arch and Gentoo</li>
<li>Issues reported with our previous release were <a class="reference external" href="https://doc.pypy.org/en/latest/whatsnew-15.11.0.html">resolved</a> after reports from users on our issue tracker at <a class="reference external" href="https://foss.heptapod.net/pypy/pypy/-/issues">https://foss.heptapod.net/pypy/pypy/-/issues</a> or on IRC at #pypy</li>
</ul>
</li>
<li>
<b>New features</b>:<ul>
<li>Add an optimization pass to vectorize loops using x86 SIMD intrinsics.</li>
<li>Support __stdcall on Windows in CFFI</li>
<li>Improve debug logging when using PYPYLOG=???</li>
<li>Deal with platforms with no RAND_egd() in OpenSSL</li>
</ul>
</li>
<li>
<b>Numpy</b>:<ul>
<li>Add support for ndarray.ctypes</li>
<li>Fast path for mixing numpy scalars and floats</li>
<li>Add support for creating Fortran-ordered ndarrays</li>
<li>Fix casting failures in linalg (by extending ufunc casting)</li>
<li>Recognize and disallow (for now) pickling of ndarrays with objects embedded in them</li>
</ul>
</li>
<li>
<b>Performance improvements and refactorings</b>:<ul class="simple">
<li>Reuse hashed keys across dictionaries and sets</li>
<li>Refactor JIT interals to improve warmup time by 20% or so at the cost of a minor regression in JIT speed</li>
<li>Recognize patterns of common sequences in the JIT backends and optimize them</li>
<li>Make the garbage collecter more incremental over external_malloc() calls</li>
<li>Share guard resume data where possible which reduces memory usage</li>
<li>Fast path for zip(list, list)</li>
<li>Reduce the number of checks in the JIT for lst[a:]</li>
<li>Move the non-optimizable part of callbacks outside the JIT</li>
<li>Factor in field immutability when invalidating heap information</li>
<li>Unroll itertools.izip_longest() with two sequences</li>
<li>Minor optimizations after analyzing output from <a class="reference external" href="https://vmprof.readthedocs.org/">vmprof</a> and trace logs</li>
<li>Remove many class attributes in rpython classes</li>
<li>Handle getfield_gc_pure* and getfield_gc_* uniformly in heap.py</li>
<li>Improve simple trace function performance by lazily calling fast2locals and locals2fast only if truly necessary </li>
</ul>
</li>
</ul>
</div>
<div class="document">
<div>
<div class="section" id="pypy-4-0-0">
<div class="section" id="other-highlights-since-2-6-1-release-two-months-ago">
Please try it out and let us know what you think. We welcome feedback, we know you are using PyPy, please tell us about it!<br>
Cheers<br>
The PyPy Team</div>
</div>
</div>
</div>
<br><br><br><br><footer><div class="rst-footer-buttons">
</div>
</footer>
</div>
      </div>
      <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/release.html" rel="tag">release</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="automatic-simd-vectorization-support-in-639063580401330508.html" rel="prev" title="Automatic SIMD vectorization support in PyPy">Previous post</a>
            </li>
            <li class="next">
                <a href="../11/pypy-401-released-please-update-2652340737298251005.html" rel="next" title="PyPy 4.0.1 released please update">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-8457809226939588640">
        <div class="comment-header">
          <a name="comment-8457809226939588640"></a>
            <span class="author">Gerrit Slonzer</span> wrote on <span class="date">2015-10-29 14:17</span>:
        </div>
        <div class="comment-content">
          <p>With the SIMD run-time detection implemented, has the --jit-backend option become redundant?</p>
        </div>
      </div>
      <div class="comment comment-1850616440123392262">
        <div class="comment-header">
          <a name="comment-1850616440123392262"></a>
            <span class="author">stryker</span> wrote on <span class="date">2015-10-29 18:07</span>:
        </div>
        <div class="comment-content">
          <p>Will a similar release be coming for Python 3.5?</p>
        </div>
      </div>
      <div class="comment comment-7206855077251711344">
        <div class="comment-header">
          <a name="comment-7206855077251711344"></a>
            <span class="author">John M. Camara</span> wrote on <span class="date">2015-10-29 21:44</span>:
        </div>
        <div class="comment-content">
          <p>@Gerrit, they are 2 different things.  One is the option to say you are interested in the SIMD support and the other is a check if SIMD support is available in the HW if you are interested in using it.  I'm sure once SIMD support has been used for some time it will eventually be enabled by default but since it is new and potential could have some unknown issues at this time you have to explicitly enable it at this time.</p>
        </div>
      </div>
      <div class="comment comment-1382153833394463986">
        <div class="comment-header">
          <a name="comment-1382153833394463986"></a>
            <span class="author">Niklas B</span> wrote on <span class="date">2015-10-30 10:07</span>:
        </div>
        <div class="comment-content">
          <p>Awesome, can't wait to try it</p>
        </div>
      </div>
      <div class="comment comment-4667104664338873092">
        <div class="comment-header">
          <a name="comment-4667104664338873092"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2015-10-30 19:31</span>:
        </div>
        <div class="comment-content">
          <p>Well done, thx!</p>
        </div>
      </div>
      <div class="comment comment-5362967467563886400">
        <div class="comment-header">
          <a name="comment-5362967467563886400"></a>
            <span class="author">Travis Griggs</span> wrote on <span class="date">2015-10-31 00:31</span>:
        </div>
        <div class="comment-content">
          <p>I keep watching the progress of PyPy with excitement. Cool things happening here. But I continue to be disappointed that it doesn't tip towards Python3. It's dead to me until that becomes the majority effort. :(</p>
        </div>
      </div>
      <div class="comment comment-6901617115002952051">
        <div class="comment-header">
          <a name="comment-6901617115002952051"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2015-10-31 00:35</span>:
        </div>
        <div class="comment-content">
          <p>The PyPy project contains a large plurality of interests. A lot of the people working on it are volunteers. So PyPy3 will happen if people within the project become interested in that part, or if new people with that interest join the project. At the moment, this seems not happening, which we can all be sad about. However, blaming anybody with differing interest for that situation feels a bit annoying to me.</p>
        </div>
      </div>
      <div class="comment comment-939996346740470106">
        <div class="comment-header">
          <a name="comment-939996346740470106"></a>
            <span class="author">Travis Griggs</span> wrote on <span class="date">2015-10-31 07:15</span>:
        </div>
        <div class="comment-content">
          <p>Well said, I apologize for any whining tone. It was not my intent to blame or complain. It really was just meant as a lamentation. Thanks for all you do.</p>
        </div>
      </div>
      <div class="comment comment-9038920002488730405">
        <div class="comment-header">
          <a name="comment-9038920002488730405"></a>
            <span class="author">PeteVine</span> wrote on <span class="date">2015-10-31 17:47</span>:
        </div>
        <div class="comment-content">
          <p>What happened to my comment? Surely the benchmark I was proposing is not censorable...</p>
        </div>
      </div>
      <div class="comment comment-1800674213620872159">
        <div class="comment-header">
          <a name="comment-1800674213620872159"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2015-10-31 18:14</span>:
        </div>
        <div class="comment-content">
          <p>@PeteVine you posted a random executable from dropbox claiming to have pypy with x87 backend. PyPy does not have an x87 backend and this raises suspitions this was just some malware. Now if you want someone to compare one thing against some other thing, please link to sources and not random binaries so the person comparing can look themselves. Additionally you did not post a benchmark, just a link to the binary</p>
        </div>
      </div>
      <div class="comment comment-6359499501352485918">
        <div class="comment-header">
          <a name="comment-6359499501352485918"></a>
            <span class="author">PeteVine</span> wrote on <span class="date">2015-10-31 19:29</span>:
        </div>
        <div class="comment-content">
          <p>Well, I was suggesting benchmarking the 32-bit backends to see how much difference SIMD makes - x87 means the standard fpu whereas the default uses SSE2. I know it's processor archaeology so you may have forgotten pypy even had it ;)<br><br>The ready-to-use pypy distro (built by me) was meant for anyone in possesion of a real set of benchmarks (not synthetic vector stuff) to be able to try it quickly.<br><br>And btw, you could have simply edited the dropbox link out. I'd already tested py3k using this backend and mentioned it in one of the issues on bitbucket so it's far from random.<br><br>@ all the people asking about pypy3 - you have the python 3.2 compatible pypy (py3k) at your disposal even now.</p>
        </div>
      </div>
      <div class="comment comment-7096114148867671580">
        <div class="comment-header">
          <a name="comment-7096114148867671580"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2015-10-31 20:54</span>:
        </div>
        <div class="comment-content">
          <p>@PeteVine: to clarify, PyPy has no JIT backend emitting the old-style x87 fpu instructions.  What you are posting is very likely a PyPy whose JIT doesn't support floats at all.  It emits calls to already-compiled functions, like the one doing addition of float objects, instead of writing a SSE2 float addition on unboxed objects.<br><br>Instead, use the official PyPy and run it with vectorization turned on and off (as documented) on the same modern machine.  This allows an apple-to-apple comparison.</p>
        </div>
      </div>
      <div class="comment comment-7643027642224710306">
        <div class="comment-header">
          <a name="comment-7643027642224710306"></a>
            <span class="author">PeteVine</span> wrote on <span class="date">2015-10-31 22:18</span>:
        </div>
        <div class="comment-content">
          <p>Thanks for clarifying, I must have confused myself after seeing it was i486 compatible.<br><br>Are you saying the only difference between the backends I wanted to benchmark would boil down to jit-emitting performance and not actual pypy performance? (I must admit I tried this a while ago with fibonacci and there was no difference at all).<br><br>In other words, even before vectorization functionality was added, shouldn't it be possible to detect that the non-SSE2 backend is running on newer hardware and use the available SIMD? (e.g. for max. compatibility)</p>
        </div>
      </div>
      <div class="comment comment-3383333846652169537">
        <div class="comment-header">
          <a name="comment-3383333846652169537"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2015-11-03 11:33</span>:
        </div>
        <div class="comment-content">
          <p>@PeteVine Sorry, I don't understand your questions.  Why do you bring the JIT-emitting performance to the table?  And why fibonacci (it's not a benchmark with floats at all)?  And I don't get the last question either ("SIMD" = "vectorization").<br><br>To some people, merely dropping the word "SIMD" into a performance discussion makes them go "ooh nice" even if they don't have a clue what it is.  I hope you're more knowledgeable than that and that I'm merely missing your point :-)</p>
        </div>
      </div>
      <div class="comment comment-7717427434714233871">
        <div class="comment-header">
          <a name="comment-7717427434714233871"></a>
            <span class="author">PeteVine</span> wrote on <span class="date">2015-11-03 13:49</span>:
        </div>
        <div class="comment-content">
          <p>The last part should have been pretty clear as it was referring to the newly added –jit vec=1 so it's not me who's dropping SIMD here (shorthand for different instructions sets) as can be seen in the title of this blog post. <br><br>All this time I was merely interested in comparing the two 32-bit backends, that's all. One's using the i486/x87 instruction set regardless of any jit codes, the other is able take advantage of anything up to SSE2. The quick fibonacci test was all I did so you could have pointed me to a real set of benchmarks instead of throwing these little jabs :)</p>
        </div>
      </div>
      <div class="comment comment-6540283040388637470">
        <div class="comment-header">
          <a name="comment-6540283040388637470"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2015-11-03 15:12</span>:
        </div>
        <div class="comment-content">
          <p>@PeteVine: ok, there is a misunderstanding somewhere, I think. Let me try to clarify: PyPy's JIT has <i>always</i> used non-SIMD SSE2 instructions to implement floating point operations. We have a slow mode where only x87 instructions are used, but usually don't fall back to that, and it does not make sense to compare against that mode.<br><br>What the new release experimentally added is support for SIMD SSE instructions using autoparallelization when --jit vec=1 is given. This only works if your program uses numpy arrays or other simple list processing code. For details on that (and for benchmarks) it's probably best to read Richard Plangger's <a href="https://pypyvecopt.blogspot.de/" rel="nofollow">blog</a>.<br><br>Does that make sense?</p>
        </div>
      </div>
      <div class="comment comment-2428231896309119812">
        <div class="comment-header">
          <a name="comment-2428231896309119812"></a>
            <span class="author">PeteVine</span> wrote on <span class="date">2015-11-03 15:46</span>:
        </div>
        <div class="comment-content">
          <p>Great, love that explanation! :)<br><br>But please, I'd really like to see how much of a handicap the much-maligned non-SSE2 backend incurs. Could you recommend a set of python (not purely computational) benchmarks so I can put this peevee of mine to rest/test?<br><br>Anyways, @Armin Rigo is a great educator himself judging from his patient replies in the bugtracker! So yeah, kudos to you guys!</p>
        </div>
      </div>
      <div class="comment comment-4846369733586970502">
        <div class="comment-header">
          <a name="comment-4846369733586970502"></a>
            <span class="author">Carl Friedrich Bolz-Tereick</span> wrote on <span class="date">2015-11-03 15:59</span>:
        </div>
        <div class="comment-content">
          <p>If you want to try a proper performance evaluation, the official benchmark set is probably the right one: https://bitbucket.org/pypy/benchmarks/<br><br>However, none of these benchmarks are exercising the new autovectorization. If you're particularly interested in that part, use the benchmarks from Richard's blog.</p>
        </div>
      </div>
      <div class="comment comment-4512951014493326581">
        <div class="comment-header">
          <a name="comment-4512951014493326581"></a>
            <span class="author">NortonCommander4ever</span> wrote on <span class="date">2015-11-09 14:33</span>:
        </div>
        <div class="comment-content">
          <p>Is there a readme on how to use these benchmarks somewhere? (preferably written with windows users in mind, if you know what I mean:))</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2025/07/pypy-v7320-release.html" class="listtitle">PyPy v7.3.20 release</a>
      </li>
      <li>
        <a href="/posts/2025/06/rpython-gc-allocation-speed.html" class="listtitle">How fast can the RPython GC allocate?</a>
      </li>
      <li>
        <a href="/posts/2025/04/prospero-in-rpython.html" class="listtitle">Doing the Prospero-Challenge in RPython</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7319-release.html" class="listtitle">PyPy v7.3.19 release</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-gc-sampling.html" class="listtitle">Low Overhead Allocation Sampling with VMProf in PyPy's GC</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7318-release.html" class="listtitle">PyPy v7.3.18 release</a>
      </li>
      <li>
        <a href="/posts/2025/01/musings-tracing.html" class="listtitle">Musings on Tracing in PyPy</a>
      </li>
      <li>
        <a href="/posts/2025/01/towards-pypy311-an-update.html" class="listtitle">Towards PyPy3.11 - an update</a>
      </li>
      <li>
        <a href="/posts/2024/11/guest-post-final-encoding-in-rpython.html" class="listtitle">Guest Post: Final Encoding in RPython Interpreters</a>
      </li>
      <li>
        <a href="/posts/2024/10/jit-peephole-dsl.html" class="listtitle">A DSL for Peephole Transformation Rules of Integer Operations in the PyPy JIT</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
            <li><a class="reference" href="/2021/">2021</a> (10)
            </li>
            <li><a class="reference" href="/2022/">2022</a> (13)
            </li>
            <li><a class="reference" href="/2023/">2023</a> (6)
            </li>
            <li><a class="reference" href="/2024/">2024</a> (13)
            </li>
            <li><a class="reference" href="/2025/">2025</a> (8)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (2)</li>
            <li><a class="reference" href="/categories/benchmarking.html">benchmarking</a> (1)</li>
            <li><a class="reference" href="/categories/casestudy.html">casestudy</a> (3)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/conda-forge.html">conda-forge</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (4)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (3)</li>
            <li><a class="reference" href="/categories/gc.html">gc</a> (3)</li>
            <li><a class="reference" href="/categories/guestpost.html">guestpost</a> (3)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (23)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/meta.html">meta</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/performance.html">performance</a> (2)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (7)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (66)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (2)</li>
            <li><a class="reference" href="/categories/rpython.html">rpython</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (6)</li>
            <li><a class="reference" href="/categories/sponsors.html">sponsors</a> (7)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/sprints.html">sprints</a> (1)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/testing.html">testing</a> (1)</li>
            <li><a class="reference" href="/categories/toy-optimizer.html">toy-optimizer</a> (5)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
            <li><a class="reference" href="/categories/vmprof.html">vmprof</a> (3)</li>
            <li><a class="reference" href="/categories/z3.html">z3</a> (5)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div class="logotext">
    © 2025 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
     
    Built with <a href="https://getnikola.com" rel="nofollow">Nikola</a>
     
    Last built 2025-07-07T11:01
  </div>
  <div style="margin-left: auto">
  <a href="../../../rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>