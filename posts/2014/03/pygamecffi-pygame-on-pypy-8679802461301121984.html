<!DOCTYPE html>
<html \ prefix="
        og: http://ogp.me/ns# article: http://ogp.me/ns/article#
    " vocab="http://ogp.me/ns" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>pygame_cffi: pygame on PyPy | PyPy</title>
<link href="../../../assets/css/rst_base.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_rst.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/styles.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../../rss.xml">
<link rel="canonical" href="https://www.pypy.org/posts/2014/03/pygamecffi-pygame-on-pypy-8679802461301121984.html">
<link rel="icon" href="../../../favicon2.ico" sizes="16x16">
<link rel="icon" href="../../../favicon32x32.ico" sizes="32x32">
<!--[if lt IE 9]><script src="../../../assets/js/html5shiv-printshiv.min.js"></script><![endif]--><link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../../../assets/css/tipuesearch.css">
<meta name="author" content="Maciej Fijalkowski">
<link rel="prev" href="hi-all-here-is-one-of-first-full-pypys-8725931424559481728.html" title="STMGC-C7 with PyPy" type="text/html">
<link rel="next" href="../04/stm-results-and-second-call-for-1767845182888902777.html" title="STM results and Second Call for Donations" type="text/html">
<meta property="og:site_name" content="PyPy">
<meta property="og:title" content="pygame_cffi: pygame on PyPy">
<meta property="og:url" content="https://www.pypy.org/posts/2014/03/pygamecffi-pygame-on-pypy-8679802461301121984.html">
<meta property="og:description" content="The Raspberry Pi aims to be a low-cost educational tool that anyone can use to learn about electronics and programming. Python and pygame are included in the Pi's programming toolkit. And since last y">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2014-03-26T16:28:00Z">
<meta property="article:tag" content="sponsors">
</head>
<body>
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="container">
             <header id="header"><!-- Adapted from https://www.taniarascia.com/responsive-dropdown-navigation-bar --><section class="navigation"><div class="nav-container">
            <div class="brand">
                <a href="../../../index.html">
                    <image id="toplogo" src="../../../images/pypy-logo.svg" width="75px;" alt="PyPy/"></image></a>
            </div>
            <nav><ul class="nav-list">
<li> 
                <a href="#!">Features</a>
                <ul class="nav-dropdown">
<li> <a href="../../../features.html">What is PyPy?</a> </li>  
                    <li> <a href="../../../compat.html">Compatibility</a> </li>  
                    <li> <a href="../../../performance.html">Performance</a> </li>  
                </ul>
</li>
          <li> <a href="../../../download.html">Download</a> </li>  
          <li> <a href="http://doc.pypy.org">Dev Docs</a> </li>  
            <li> 
                <a href="#!">Blog</a>
                <ul class="nav-dropdown">
<li> <a href="../../../blog/">Index</a> </li>  
                    <li> <a href="../../../categories/">Tags</a> </li>  
                    <li> <a href="../../../archive.html">Archive by year</a> </li>  
                    <li> <a href="../../../rss.xml">RSS feed</a> </li>  
                    <li> <a href="https://morepypy.blogspot.com/">Old site</a> </li>  
                </ul>
</li>
            <li> 
                <a href="#!">About</a>
                <ul class="nav-dropdown">
<li> <a href="https://bsky.app/profile/pypyproject.bsky.social">Bluesky</a> </li>  
                    <li> <a href="https://libera.irclog.whitequark.org/pypy">IRC logs</a> </li>  
                    <li> <a href="https://www.youtube.com/playlist?list=PLADqad94yVqDRQXuqxKrPS5QnVqbDLlRt">YouTube</a> </li>  
                    <li> <a href="https://www.twitch.tv/pypyproject">Twitch</a> </li>  
                    <li> <a href="../../../pypy-sponsors.html">Sponsors</a> </li>  
                    <li> <a href="../../../howtohelp.html">How To Help?</a> </li>  
                    <li> <a href="../../../contact.html">Contact</a> </li>  
                </ul>
</li>

                </ul></nav><div class="nav-mobile">
                <a id="nav-toggle" href="#!"> <span></span></a>
            </div>
        </div>
    </section><div class="searchform" role="search">
                
<form class="navbar-form navbar-left" action="../../../search.html" role="search">
    <div class="form-group">
        <input type="text" class="form-control" id="tipue_search_input" name="q" placeholder="Search…" autocomplete="off">
</div>
    <input type="submit" value="Local Search" style="visibility: hidden;">
</form>

            </div>
    </header><main id="content"><article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><div class="post">
          <header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">pygame_cffi: pygame on PyPy</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    <a class="u-url" href="../../../authors/maciej-fijalkowski.html">Maciej Fijalkowski</a>
            </span></p>
            <p class="dateline">
            <a href="#" rel="bookmark">
            <time class="published dt-published" datetime="2014-03-26T16:28:00Z" itemprop="datePublished" title="2014-03-26 16:28">2014-03-26 16:28</time></a>
            </p>
                <p class="commentline">40 comments</p>

                <p class="commentline">            <a href="pygamecffi-pygame-on-pypy-8679802461301121984.html#utterances-thread">Comments</a>


            
        </p>
</div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
      <div dir="ltr" style="text-align: left;">
<p>The Raspberry Pi aims to be a low-cost educational tool that anyone can use to learn about electronics and programming. Python and <a class="reference external" href="https://pygame.org/news.html">pygame</a> are included in the Pi's programming toolkit. And since last year, thanks in part to sponsorship from the <a class="reference external" href="https://www.raspberrypi.org/">Raspberry Pi Foundation</a>, PyPy also works on the Pi (read more <a class="reference external" href="../../2013/05/pypy-20-alpha-for-arm-2318299473927531503.html">here</a>).</p>
<p>With PyPy working on the Pi, game logic written in Python stands to gain an awesome performance boost. However, the original pygame is a Python C extension. This means it performs poorly on PyPy and negates any speedup in the Python parts of the game code.</p>
<p>One solution to making pygame games run faster on PyPy, and eventually on the Raspberry Pi, comes in the form of <a class="reference external" href="https://github.com/CTPUG/pygame_cffi">pygame_cffi</a>. pygame_cffi uses <a class="reference external" href="https://cffi.readthedocs.org/">CFFI</a> to wrap the underlying SDL library instead of a C extension. A few months ago, the Raspberry Pi Foundation sponsored a <a class="reference external" href="../../2013/12/pygame-cffi-8991437796535033699.html">Cape Town Python User Group hackathon</a> to build a proof-of-concept pygame using CFFI. This hackathon was a success and it produced an early working version of pygame_cffi.</p>
<p>So for the last 5 weeks Raspberry Pi has been funding work on pygame_cffi. The goal was a complete implementation of the core modules. We also wanted benchmarks to illuminate performance differences between pygame_cffi on PyPy and pygame on CPython. We are happy to report that those goals were met. So without further ado, here's a rundown of what works.</p>
<div class="section" id="current-functionality">
<h3>Current functionality<a href="#current-functionality" class="headerlink" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li>
<a class="reference external" href="https://www.pygame.org/docs/ref/surface.html">Surfaces</a> support all the usual flags for SDL and OpenGL rendering (more about OpenGL <a class="reference internal" href="pygamecffi-pygame-on-pypy-8679802461301121984.html#pyopenglperformance">below</a>).</li>
<li>The graphics-related modules <a class="reference external" href="https://www.pygame.org/docs/ref/color.html">color</a>, <a class="reference external" href="https://www.pygame.org/docs/ref/display.html">display</a>, <a class="reference external" href="https://www.pygame.org/docs/ref/font.html">font</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/image.html">image</a>, and parts of <a class="reference external" href="https://www.pygame.org/docs/ref/draw.html">draw</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/transform.html">transform</a> are mostly complete.</li>
<li>
<a class="reference external" href="https://www.pygame.org/docs/ref/event.html">Events</a>! No <a class="reference external" href="https://www.pygame.org/docs/ref/fastevent.html">fastevent</a> module yet, though.</li>
<li>Mouse and keyboard functionality, as provided by the <a class="reference external" href="https://www.pygame.org/docs/ref/mouse.html">mouse</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/key.html">key</a> modules, is complete.</li>
<li>Sound functionality, as provided by the <a class="reference external" href="https://www.pygame.org/docs/ref/mixer.html">mixer</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/music.html">music</a> modules, is complete.</li>
<li>Miscellaneous modules, <a class="reference external" href="https://www.pygame.org/docs/ref/cursors.html">cursors</a>, <a class="reference external" href="https://www.pygame.org/docs/ref/rect.html">rect</a>, <a class="reference external" href="https://www.pygame.org/docs/ref/sprite.html">sprite</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/time.html">time</a> are also complete.</li>
</ul>

Invention screenshot:

<div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-1ZVah86dW3s/UzL9ZhiDiKI/AAAAAAAABvI/kMO9Pnmq9FY/s1600/invention_screenshot.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-1ZVah86dW3s/UzL9ZhiDiKI/AAAAAAAABvI/kMO9Pnmq9FY/s320/invention_screenshot.png"></a></div>

Mutable mamba screenshot:

<div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-JZzDhMwp43s/UzL9g4lktwI/AAAAAAAABvQ/WuCvtbCA3Lc/s1600/mutable_mamba_screenshot.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://2.bp.blogspot.com/-JZzDhMwp43s/UzL9g4lktwI/AAAAAAAABvQ/WuCvtbCA3Lc/s320/mutable_mamba_screenshot.png"></a></div>

<p>With the above-mentioned functionality in place we could get 10+ of the pygame examples to work, and a number of <a class="reference external" href="https://pyweek.org/">PyWeek</a> games. At the time of writing, if a game doesn't work it is most likely due to an unimplemented <a class="reference external" href="https://www.pygame.org/docs/ref/transform.html">transform</a> or <a class="reference external" href="https://www.pygame.org/docs/ref/draw.html">draw</a> function. That will be remedied soon.</p>
</div>
<div class="section" id="performance">
<h3>Performance<a href="#performance" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>In terms of performance, pygame_cffi on PyPy is showing a lot of promise. It beats pygame on CPython by a significant margin in our events processing and collision detection benchmarks, while blit and fill benchmarks perform similarly. The pygame examples we checked also perform better.</p>

<div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-tSV6v3J5rwc/UzL-4CbkqCI/AAAAAAAABwQ/NFDuq4biNqY/s1600/collision_increase.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-tSV6v3J5rwc/UzL-4CbkqCI/AAAAAAAABwQ/NFDuq4biNqY/s400/collision_increase.png"></a></div>

<div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-HJCdpeVHbj0/UzL-0e5eGMI/AAAAAAAABwI/3eKRVRpP45s/s1600/examples_bench.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://1.bp.blogspot.com/-HJCdpeVHbj0/UzL-0e5eGMI/AAAAAAAABwI/3eKRVRpP45s/s400/examples_bench.png"></a></div>

<p>However, there is still work to be done to identify and eliminate bottlenecks. On the Raspberry Pi performance is markedly worse compared to pygame (barring collision detection). The PyWeek games we tested also performed slightly worse. Fortunately there is room for improvement in various places.</p>

Invention &amp; Mutable Mamba (x86)

<div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-jYdr73oj154/UzL-u4aAwWI/AAAAAAAABwA/cv_vNSFtb0Q/s1600/pyweek_games_bench.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://4.bp.blogspot.com/-jYdr73oj154/UzL-u4aAwWI/AAAAAAAABwA/cv_vNSFtb0Q/s400/pyweek_games_bench.png"></a></div>

Standard pygame examples (Raspberry Pi)

<div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-gd9KEHANb_I/UzL-oKCx5BI/AAAAAAAABv4/frssbcGhI9A/s1600/examples_bench_rasp.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://2.bp.blogspot.com/-gd9KEHANb_I/UzL-oKCx5BI/AAAAAAAABv4/frssbcGhI9A/s400/examples_bench_rasp.png"></a></div>

<p>Here's a summary of some of the benchmarks. Relative speed refers to the frame rate obtained in pygame_cffi on PyPy relative to pygame on CPython.</p>
<table border="1" class="docutils">
<colgroup>
<col width="76%">
<col width="24%">
</colgroup>
<thead valign="bottom"><tr>
<th class="head">Benchmark</th>
<th class="head">Relative speed (pypy speedup)</th>
</tr></thead>
<tbody valign="top">
<tr>
<td>Events (x86)</td>
<td>1.41</td>
</tr>
<tr>
<td>Events (Pi)</td>
<td>0.58</td>
</tr>
<tr>
<td>N<sup>2</sup> collision detection on 100 sprites (x86)</td>
<td>4.14</td>
</tr>
<tr>
<td>N<sup>2</sup> collision detection on 100 sprites (Pi)</td>
<td>1.01</td>
</tr>
<tr>
<td>Blit 100 surfaces (x86)</td>
<td>1.06</td>
</tr>
<tr>
<td>Blit 100 surfaces (Pi)</td>
<td>0.60</td>
</tr>
<tr>
<td>Invention (x86)</td>
<td>0.95</td>
</tr>
<tr>
<td>Mutable Mamba (x86)</td>
<td>0.72</td>
</tr>
<tr>
<td>stars example (x86)</td>
<td>1.95</td>
</tr>
<tr>
<td>stars example (Pi)</td>
<td>0.84</td>
</tr>
</tbody>
</table>
<div class="section" id="opengl">
<h2>OpenGL<a href="#opengl" class="headerlink" title="Permalink to this heading">¶</a></h2>
<p id="pyopenglperformance">Some not-so-great news is that <a class="reference external" href="https://pyopengl.sourceforge.net/">PyOpenGL</a> performs poorly on PyPy since PyOpenGL uses ctypes. This translates into a nasty reduction in frame rate for games that use OpenGL surfaces. It might be worthwhile creating a CFFI-powered version of PyOpenGL as well.</p>
</div>
</div>
<div class="section" id="where-to-now">
<h3>Where to now?<a href="#where-to-now" class="headerlink" title="Permalink to this heading">¶</a></h3>
<p>Work on pygame_cffi is ongoing. Here are some things that are in the pipeline:</p>
<ul class="simple">
<li>Get pygame_cffi on PyPy to a place where it is consistently faster than pygame on CPython.</li>
<li>Implement the remaining modules and functions, starting with <a class="reference external" href="https://www.pygame.org/docs/ref/draw.html">draw</a> and <a class="reference external" href="https://www.pygame.org/docs/ref/transform.html">transform</a>.</li>
<li>Improve test coverage.</li>
<li>Reduce the time it takes for CFFI to parse the cdef. This makes the initial pygame import slow.</li>
</ul>
<p>If you want to contribute you can find pygame_cffi <a class="reference external" href="https://github.com/CTPUG/pygame_cffi">on Github</a>.
Feel free to find us on #pypy on freenode or post issues on github.</p>
<p>Cheers,<br>
Rizmari Versfeld</p>
</div>
<br>
</div>
      </div>
      <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../../categories/sponsors.html" rel="tag">sponsors</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="hi-all-here-is-one-of-first-full-pypys-8725931424559481728.html" rel="prev" title="STMGC-C7 with PyPy">Previous post</a>
            </li>
            <li class="next">
                <a href="../04/stm-results-and-second-call-for-1767845182888902777.html" rel="next" title="STM results and Second Call for Donations">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
                <div class="comment-level comment-level-1">
      <div class="comment comment-1655733976004847288">
        <div class="comment-header">
          <a name="comment-1655733976004847288"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-28 01:04</span>:
        </div>
        <div class="comment-content">
          <p>Pygame should be an excellent way to benchmark the performance of pypy, so this is great!  I wanted to let you fellas know of another project that is using pypy that looks really neat as well... https://github.com/rfk/pypyjs</p>
        </div>
      </div>
      <div class="comment comment-8249132770798691487">
        <div class="comment-header">
          <a name="comment-8249132770798691487"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-28 12:46</span>:
        </div>
        <div class="comment-content">
          <p>pygame seems outdated, because it is based on first SDL version.<br><br>It will be interesting to see CFFI comparison for newer, SDL2 bindings, such as PySDL2, which is ctypes based at the moment.<br><br>https://pypi.python.org/pypi/PySDL2</p>
        </div>
      </div>
      <div class="comment comment-2197101148120095862">
        <div class="comment-header">
          <a name="comment-2197101148120095862"></a>
            <span class="author">Maciej Fijalkowski</span> wrote on <span class="date">2014-03-28 15:02</span>:
        </div>
        <div class="comment-content">
          <p>Anatoly, pygame is outdated but have no clear replacement. PySDL2 is nice, but it's only a low level binding, it does not really help in the case of writing games.</p>
        </div>
      </div>
      <div class="comment comment-3756951900884338415">
        <div class="comment-header">
          <a name="comment-3756951900884338415"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-28 18:31</span>:
        </div>
        <div class="comment-content">
          <p>Is it not wrapping the current SDL?  I thought that it was...  On github it says it's a pygame based wrapper(copies the api) for SDL, would that not make it the current SDL?</p>
        </div>
      </div>
      <div class="comment comment-7209139772900464696">
        <div class="comment-header">
          <a name="comment-7209139772900464696"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2014-03-29 00:37</span>:
        </div>
        <div class="comment-content">
          <p>I looked into PyOpenGL's code to see if there is an easy way to upgrade to CFFI.<br><br>It's a bag of cats EVERYWHERE. <br><br>ctypes are defined all over the place, unlike most ctypes-&gt;cffi projects, where there is a single source file (api.py) that is easy to convert due to it being the raw interface to the C library.<br><br></p>
        </div>
      </div>
      <div class="comment comment-805625527457221648">
        <div class="comment-header">
          <a name="comment-805625527457221648"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-29 06:41</span>:
        </div>
        <div class="comment-content">
          <p>@Maciej, pygame includes a lot of helpers and good documentation, but it is not perspective technology to play with. I'd say there are more interesting libs out there that gain more interesting results and speeding up dynamic binding for them would be very cool to make things like these - https://devart.withgoogle.com/ - possible.<br><br><br>@Anonymous, if I were to provide OpenGL bindings, I'd start with looking at https://github.com/p3/regal project and binding generator in scripts/</p>
        </div>
      </div>
      <div class="comment comment-2013483921445808712">
        <div class="comment-header">
          <a name="comment-2013483921445808712"></a>
            <span class="author">Temia Eszteri</span> wrote on <span class="date">2014-03-29 18:42</span>:
        </div>
        <div class="comment-content">
          <p>I've actually been working to see if I can get my own Pygame release, Sky Eraser, optimised enough to work on a Raspberry Pi -- it'd be worth seeing how implementing it under this configuration would work on top of the optimisations I've been working on in the background (boy are there a lot to make).<br><br>I might also be rewriting the APIs for Allegro 5.1 as an experiment though, to test under both CPython and PyPy.</p>
        </div>
      </div>
      <div class="comment comment-6204412962320323650">
        <div class="comment-header">
          <a name="comment-6204412962320323650"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-29 21:15</span>:
        </div>
        <div class="comment-content">
          <p>I started to work on a newer and experimental OpenGL wrapper for Python,  proudly blessed PyOpenGLng.<br><br>In comparison to PyOpenGL, it generates the requested OpenGL API from the OpenGL XML Registry and use an automatic translator to map the C API to Python. The translator is quite light weight in comparison to PyOpenGL source code. And it is already able to run a couple of examples for OpenGL V3 and V4.<br><br>Actually the wrapper use ctypes. But I am looking for tips to do the same for cffi, as well as feedbacks on performance and comments.<br><br>The project is hosted on https://github.com/FabriceSalvaire/PyOpenGLng.</p>
        </div>
      </div>
      <div class="comment comment-1437180940869577437">
        <div class="comment-header">
          <a name="comment-1437180940869577437"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-30 08:16</span>:
        </div>
        <div class="comment-content">
          <p>@Fabrice, how is your newer and experimental OpenGL wrapper generator is better than existing ones? I am not saying that there is a NIH effect - probably some omission from documentation.</p>
        </div>
      </div>
      <div class="comment comment-8926413427958821430">
        <div class="comment-header">
          <a name="comment-8926413427958821430"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-30 08:19</span>:
        </div>
        <div class="comment-content">
          <p>I mean that if PyOpenGL doesn't use wrapper generator then there are a couple around not limiting themselves to Python. I am especially interested to know the comparison with regal.</p>
        </div>
      </div>
      <div class="comment comment-342599703653596616">
        <div class="comment-header">
          <a name="comment-342599703653596616"></a>
            <span class="author">Alecks Gates</span> wrote on <span class="date">2014-03-30 22:20</span>:
        </div>
        <div class="comment-content">
          <p>It was my impression that OpenGL isn't hardware accelerated on the pi anyway... or am I incorrect?</p>
        </div>
      </div>
      <div class="comment comment-3915197357064046080">
        <div class="comment-header">
          <a name="comment-3915197357064046080"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-03-31 10:17</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly: The only real replacement for pygame which I know is pyglet. It is not quite as game-optimized as pygame, but very versatile and a joy to use.<br><br>https://pyglet.org</p>
        </div>
      </div>
      <div class="comment comment-4800815379467947206">
        <div class="comment-header">
          <a name="comment-4800815379467947206"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-01 20:05</span>:
        </div>
        <div class="comment-content">
          <p>I've actually made a CFFI OpenGL binding, as part of my successor to my old PyGL3Display project. It's not hosted anywhere yet, but I'll see about getting up somewhere soon.</p>
        </div>
      </div>
      <div class="comment comment-1569339313098984299">
        <div class="comment-header">
          <a name="comment-1569339313098984299"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-02 14:32</span>:
        </div>
        <div class="comment-content">
          <p>And... done. A mostly drop-in replacement for PyOpenGL on CFFI, or at least for OpenGL 3.2 core spec.<br><br>https://www.dropbox.com/s/rd44asge17xjbn2/gl32.zip</p>
        </div>
      </div>
      <div class="comment comment-2979420898382012559">
        <div class="comment-header">
          <a name="comment-2979420898382012559"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-02 14:35</span>:
        </div>
        <div class="comment-content">
          <p>@Arne, pyglet rocks, because it is just `clone and run` unlike all other engines. But it looks a little outdated, that's why I started to look for alternatives.</p>
        </div>
      </div>
      <div class="comment comment-1334842746653621045">
        <div class="comment-header">
          <a name="comment-1334842746653621045"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-02 14:38</span>:
        </div>
        <div class="comment-content">
          <p>@David, if you want people to comment on this, Bitbucket would be a better way to share sources than Dropbox.</p>
        </div>
      </div>
      <div class="comment comment-5844610699095504300">
        <div class="comment-header">
          <a name="comment-5844610699095504300"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-02 14:57</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly techtonick:<br>Actually, it'll end up on Launchpad in the near future (probably within 2 weeks?). However, it's the output of a wrapper generator and the wrapper generator is in pretty poor shape at the moment, in terms of packaging it's output. I just figured people might be able to use it in the near future, even if it is in 'source-code-dump' form. If there's a better temporary home for it somewhere, I'm all ears.</p>
        </div>
      </div>
      <div class="comment comment-907211568521745319">
        <div class="comment-header">
          <a name="comment-907211568521745319"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-02 15:08</span>:
        </div>
        <div class="comment-content">
          <p>@David, why reinvent the wheel? There are many wrapper generators around. Also, you project is not a replacement for PyOpenGL, because of GPL restrictions.</p>
        </div>
      </div>
      <div class="comment comment-392554119337358909">
        <div class="comment-header">
          <a name="comment-392554119337358909"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-02 15:39</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly<br><br>I never claimed my project is a replacement for PyOpenGL - it's not API compatible, for a start. Regarding license, it'll probably get changed for the bindings at some point, probably to 3-clause BSD.<br><br>On the wrapper generator: Really, the only actively maintained wrapper generator for Python that I'm aware of (which isn't project specific) is SWIG, which is not appropriate (at the very least, googling for 'python wrapper generator -swig' doesn't seem to give many results). In any case, the wrapper generator isn't a lot of code.</p>
        </div>
      </div>
      <div class="comment comment-3573871793579930149">
        <div class="comment-header">
          <a name="comment-3573871793579930149"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 07:28</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly: pyglet seems to be in maintenance mode right now. There are commits every few days, but only small stuff.<br><br>On the other hand I understand that: pyglet supplies everything a backend for a game-engine needs (I use it¹), so the next step should be to use it for many games and see whether shared needs arise.<br><br>¹: See https://1w6.org/deutsch/anhang/programme/hexbattle-mit-zombies and https://bitbucket.org/ArneBab/hexbattle/</p>
        </div>
      </div>
      <div class="comment comment-1490435339316396207">
        <div class="comment-header">
          <a name="comment-1490435339316396207"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 10:35</span>:
        </div>
        <div class="comment-content">
          <p>@David, I am speaking about OpenGL specific wrapper generators. I've added information to this page - https://www.opengl.org/wiki/Related_toolkits_and_APIs#OpenGL_loading_libraries<br><br>The OpenGL generator in Python is included in regal project here https://github.com/p3/regal/scripts<br><br>pyglet also has one.</p>
        </div>
      </div>
      <div class="comment comment-1118721639684635338">
        <div class="comment-header">
          <a name="comment-1118721639684635338"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 10:36</span>:
        </div>
        <div class="comment-content">
          <p>Sorry, the correct link is https://github.com/p3/regal/tree/master/scripts</p>
        </div>
      </div>
      <div class="comment comment-2780282584915669970">
        <div class="comment-header">
          <a name="comment-2780282584915669970"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 10:39</span>:
        </div>
        <div class="comment-content">
          <p>@Arne, kissing elves trick is low. =) Otherwise looks wesnothy and 2D. I don't see why it should use OpenGL. 3D models would be cool.<br><br>I'd try to make it run on PySDL2 with "from sdl2.ext.api import pyglet". There is no pyglet API there, but would be interesting to see if it is possible to provide one.</p>
        </div>
      </div>
      <div class="comment comment-6207023902483125812">
        <div class="comment-header">
          <a name="comment-6207023902483125812"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-03 15:58</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly<br><br>Pyglet's GL wrapper generator creates a lot of chained functions (fairly slow in cPython). I'm also not sure if there's enough development activity in Pyglet to allow modifying core code, and given the size of the Pyglet project I'm not going to fork it. PyOpenGL has more or less the same issues.<br><br>Regal appears to be a very large project (a 68MB checkout), which has a scope much greater than just its wrapper generator - the sheer scope of the project does cause some barriers to entry. I'm still looking through, but I am fairly certain that it would take more effort to adapt Regals binding generator than I have expended on my own.</p>
        </div>
      </div>
      <div class="comment comment-9071520511276958069">
        <div class="comment-header">
          <a name="comment-9071520511276958069"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 21:06</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly: I like kissing elves ☺ (and when I get to write the next part of the story, I intend to keep them as player characters: That someone starts out in an intimate moment does not mean he or she is watchmeat).<br><br>@David: I guess modifying core-code in pyglet is not that big of a problem, especially *because* it is mostly being maintained right now: Little danger of breaking the in-progress work of someone else.</p>
        </div>
      </div>
      <div class="comment comment-2366334588211182049">
        <div class="comment-header">
          <a name="comment-2366334588211182049"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-03 21:09</span>:
        </div>
        <div class="comment-content">
          <p>@anatoly: more specifically, I do not consider intimate moments as cheap (and WTactics has the image, so I could pull this off). Instead I try to rid myself of baseless inhibitions, though that’s not always easy: Killing off no longer needed societal conditioning is among the hardest battles…</p>
        </div>
      </div>
      <div class="comment comment-8901268274616702486">
        <div class="comment-header">
          <a name="comment-8901268274616702486"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-04 01:23</span>:
        </div>
        <div class="comment-content">
          <p>@Arne: Maybe it'd be worth looking at integrating it then; however, it really is a completely different approach - gl32 is a source code writer, whereas Pyglet uses Pythons inbuilt metaprogramming capabilities - and so it would be completely rewriting a large chunk of Pyglets core. Once I've got the binding generator finalised, it might be worth seeing if it's possible to replace Pyglet's OpenGL bindings with these ones.<br><br>That said, in the interest of full disclosure: I'm not a fan of Pyglets per object draw method, again in the interests of speed. The per object draw method that Pyglet encourages with its API is not very scalable and eliminates a large number of the advantages of using OpenGL. So whilst I might see if gl32 can be plugged in for interesting benchmarks/proof-of-concept, I probably wouldn't try to get it bug-free and integrated into upstream Pyglet.</p>
        </div>
      </div>
      <div class="comment comment-3616231432826004421">
        <div class="comment-header">
          <a name="comment-3616231432826004421"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-04 15:26</span>:
        </div>
        <div class="comment-content">
          <p>@Arne: Regarding Pyglet integration - it seems it would require a lot of work. There's two major issues - firstly, Pyglet only has raw OpenGL bindings, which are used everywhere and hence the "more pythonic" bindings of gl32 would be hard to integrate without editing every file using GL in Pyglet. Secondly, Pyglet uses GL functions which were removed in 3.2, and hence are not in gl32, so the API generator would have to be extended to handle any special cases on these functions.</p>
        </div>
      </div>
      <div class="comment comment-1356665352638378268">
        <div class="comment-header">
          <a name="comment-1356665352638378268"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-07 17:23</span>:
        </div>
        <div class="comment-content">
          <p>@David: The per-object draw-method is very convenient for programming. As soon as you need more performance, most of the objects are grouped into batches, though. That way only the draw method of the batch is called and the batch can do all kinds of optimizations.</p>
        </div>
      </div>
      <div class="comment comment-1417474657930851444">
        <div class="comment-header">
          <a name="comment-1417474657930851444"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-07 17:25</span>:
        </div>
        <div class="comment-content">
          <p>For Python 3.2 you might find useful stuff in the python-3 port of pyglet, though that hasn’t been released, yet, IIRC.</p>
        </div>
      </div>
      <div class="comment comment-6538215610814316240">
        <div class="comment-header">
          <a name="comment-6538215610814316240"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-07 21:26</span>:
        </div>
        <div class="comment-content">
          <p>@Arne:<br><br>I'd argue that objects with Z-order would be more convenient programmatically, but frankly that's a matter of opinion. (Incidentally, this is something I'm working on as well, and I think I'm mostly done on it). <br><br>However, per-object-draw is only one concern I have on Pyglets speed credentials, as I do not believe Pyglet was written with speed as a design goal. For a different example, see pyglet.graphics.vertexbuffer; copying a ctypes object into a list in order to get slices to work is not a smart thing to do, performance wise!<br><br>I'm not sure where you got Python 3.2 from, but what I meant was that currently I'm restricting myself to OpenGL 3.2, which means that certain older OpenGL functions do not exist. Pyglet uses some of these removed functions (e.g. glPushClientAttrib), and hence the bindings I'm generating at the moment do not provide all the features Pyglet uses.</p>
        </div>
      </div>
      <div class="comment comment-8340463375497750517">
        <div class="comment-header">
          <a name="comment-8340463375497750517"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2014-04-08 04:47</span>:
        </div>
        <div class="comment-content">
          <p>I'd like to remind readers of these comments that this thread has gone farther and farther from both the original post and the whole blog -- which is supposed to be related to PyPy.  I'm rather sure that you're now discussing performance on CPython, which in this case is very different from performance on PyPy (or would be if it supported all packages involved).  Maybe move this discussion somewhere more appropriate?</p>
        </div>
      </div>
      <div class="comment comment-1918749471660495806">
        <div class="comment-header">
          <a name="comment-1918749471660495806"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-09 11:47</span>:
        </div>
        <div class="comment-content">
          <p>@Armin: You’re right… actually I would be pretty interested, though, whether pypy also has a performance issue with pyglet's chained functions.</p>
        </div>
      </div>
      <div class="comment comment-8870180920478767155">
        <div class="comment-header">
          <a name="comment-8870180920478767155"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-09 14:30</span>:
        </div>
        <div class="comment-content">
          <p>@Arne: In principal, PyPy seems to handle Pyglets chained functions relatively well (non-scientifically running the Astraea examples title screen sees CPU usage start very high, but eventually drops to about 80% of cPythons after the JIT warms up). There is one caveat preventing better testing: the moment keyboard input is given to Astraea on PyPy, PyPy segfaults.</p>
        </div>
      </div>
      <div class="comment comment-4514310958986189673">
        <div class="comment-header">
          <a name="comment-4514310958986189673"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-10 09:05</span>:
        </div>
        <div class="comment-content">
          <p>@David: That is a really important feedback to Armin and and Anatoly, I think.</p>
        </div>
      </div>
      <div class="comment comment-2897705282695531406">
        <div class="comment-header">
          <a name="comment-2897705282695531406"></a>
            <span class="author">Unknown</span> wrote on <span class="date">2014-04-10 09:06</span>:
        </div>
        <div class="comment-content">
          <p>@David: Can you give some more background on the error (how to get the code, how to reproduce the segfault)?</p>
        </div>
      </div>
      <div class="comment comment-7159537636839667973">
        <div class="comment-header">
          <a name="comment-7159537636839667973"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-15 11:35</span>:
        </div>
        <div class="comment-content">
          <p>@Arne: It's as simple as running the Astraea example in Pyglet and pressing a key (under PyPy 2.2, Pyglet 1.2-beta, Ubuntu 14.04). As far as I remember, this has been the case for some time (at least as far back as Ubuntu 12.10/PyPy 2.0 beta - although back then the major issue was PyPy using a lot more CPU; I didn't report this then due to a blog post at the time saying how cTypes would be rewritten). The error reported by Apport is "Cannot access memory at address 0x20"<br><br>Doing a cursory scan through other examples, the noisy and text_input examples also have problems. noisy segfaults when a spawned ball collides with a boundary (occasionally giving a partial rpython traceback); text_input appears to have a random chance of any of the input boxes being selectable.<br><br>Maybe it's time to file a proper bug report on this...</p>
        </div>
      </div>
      <div class="comment comment-6821195969382759213">
        <div class="comment-header">
          <a name="comment-6821195969382759213"></a>
            <span class="author">David</span> wrote on <span class="date">2014-04-15 14:09</span>:
        </div>
        <div class="comment-content">
          <p>@Arne: I've now submitted a bug on the PyPy Bug tracker (Issue 1736), with more detail etc. Probably best to move conversation on any Pyglet related issues over there.</p>
        </div>
      </div>
      <div class="comment comment-3498460290294515473">
        <div class="comment-header">
          <a name="comment-3498460290294515473"></a>
            <span class="author">Armin Rigo</span> wrote on <span class="date">2014-04-16 11:50</span>:
        </div>
        <div class="comment-content">
          <p>Maybe indeed :-)</p>
        </div>
      </div>
      <div class="comment comment-1241565184074256430">
        <div class="comment-header">
          <a name="comment-1241565184074256430"></a>
            <span class="author">Anonymous</span> wrote on <span class="date">2015-01-24 15:22</span>:
        </div>
        <div class="comment-content">
          <p>I came up with a funny idea about why not making emscripten generates code targeted on RPython, then now we can use C/C++ in PyPy directly? A LLVM to RPython compiler, how about this?</p>
        </div>
      </div>
         </div>

          </section>
</div>
    <div class="sidebar">
<div>
  <h2>
    The PyPy blogposts
  </h2>
  <div>
    Create a guest post via a PR to the <a href="https://github.com/pypy/pypy.org">source repo</a>
  </div>
</div>
    <div id="global-recent-posts">
    <h2>
      Recent Posts
    </h2>
    <ul class="post-list">
      <li>
        <a href="/posts/2025/12/toy-load-store.html" class="listtitle">Load and store forwarding in the Toy Optimizer</a>
      </li>
      <li>
        <a href="/posts/2025/07/pypy-v7320-release.html" class="listtitle">PyPy v7.3.20 release</a>
      </li>
      <li>
        <a href="/posts/2025/06/rpython-gc-allocation-speed.html" class="listtitle">How fast can the RPython GC allocate?</a>
      </li>
      <li>
        <a href="/posts/2025/04/prospero-in-rpython.html" class="listtitle">Doing the Prospero-Challenge in RPython</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7319-release.html" class="listtitle">PyPy v7.3.19 release</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-gc-sampling.html" class="listtitle">Low Overhead Allocation Sampling with VMProf in PyPy's GC</a>
      </li>
      <li>
        <a href="/posts/2025/02/pypy-v7318-release.html" class="listtitle">PyPy v7.3.18 release</a>
      </li>
      <li>
        <a href="/posts/2025/01/musings-tracing.html" class="listtitle">Musings on Tracing in PyPy</a>
      </li>
      <li>
        <a href="/posts/2025/01/towards-pypy311-an-update.html" class="listtitle">Towards PyPy3.11 - an update</a>
      </li>
      <li>
        <a href="/posts/2024/11/guest-post-final-encoding-in-rpython.html" class="listtitle">Guest Post: Final Encoding in RPython Interpreters</a>
      </li>
    </ul>
  </div>

          <div id="global-archive-list">
          <h2>
            Archives
          </h2>
          <ul class="archive-level archive-level-1">
            <li><a class="reference" href="/2007/">2007</a> (19)
            </li>
            <li><a class="reference" href="/2008/">2008</a> (62)
            </li>
            <li><a class="reference" href="/2009/">2009</a> (38)
            </li>
            <li><a class="reference" href="/2010/">2010</a> (44)
            </li>
            <li><a class="reference" href="/2011/">2011</a> (43)
            </li>
            <li><a class="reference" href="/2012/">2012</a> (44)
            </li>
            <li><a class="reference" href="/2013/">2013</a> (46)
            </li>
            <li><a class="reference" href="/2014/">2014</a> (22)
            </li>
            <li><a class="reference" href="/2015/">2015</a> (20)
            </li>
            <li><a class="reference" href="/2016/">2016</a> (20)
            </li>
            <li><a class="reference" href="/2017/">2017</a> (13)
            </li>
            <li><a class="reference" href="/2018/">2018</a> (12)
            </li>
            <li><a class="reference" href="/2019/">2019</a> (12)
            </li>
            <li><a class="reference" href="/2020/">2020</a> (9)
            </li>
            <li><a class="reference" href="/2021/">2021</a> (10)
            </li>
            <li><a class="reference" href="/2022/">2022</a> (13)
            </li>
            <li><a class="reference" href="/2023/">2023</a> (6)
            </li>
            <li><a class="reference" href="/2024/">2024</a> (13)
            </li>
            <li><a class="reference" href="/2025/">2025</a> (9)
            </li>
          </ul>
        </div>


          <div id="global-tag-list">
          <h2>
            Tags
          </h2>
          <ul>
            <li><a class="reference" href="/categories/arm.html">arm</a> (2)</li>
            <li><a class="reference" href="/categories/benchmarking.html">benchmarking</a> (1)</li>
            <li><a class="reference" href="/categories/casestudy.html">casestudy</a> (3)</li>
            <li><a class="reference" href="/categories/cli.html">cli</a> (1)</li>
            <li><a class="reference" href="/categories/compiler.html">compiler</a> (1)</li>
            <li><a class="reference" href="/categories/conda-forge.html">conda-forge</a> (1)</li>
            <li><a class="reference" href="/categories/cpyext.html">cpyext</a> (4)</li>
            <li><a class="reference" href="/categories/cpython.html">CPython</a> (3)</li>
            <li><a class="reference" href="/categories/ep2008.html">ep2008</a> (1)</li>
            <li><a class="reference" href="/categories/extension-modules.html">extension modules</a> (3)</li>
            <li><a class="reference" href="/categories/gc.html">gc</a> (3)</li>
            <li><a class="reference" href="/categories/guestpost.html">guestpost</a> (3)</li>
            <li><a class="reference" href="/categories/graalpython.html">GraalPython</a> (1)</li>
            <li><a class="reference" href="/categories/hpy.html">hpy</a> (1)</li>
            <li><a class="reference" href="/categories/heptapod.html">Heptapod</a> (1)</li>
            <li><a class="reference" href="/categories/jit.html">jit</a> (23)</li>
            <li><a class="reference" href="/categories/jython.html">jython</a> (1)</li>
            <li><a class="reference" href="/categories/kcachegrind.html">kcachegrind</a> (1)</li>
            <li><a class="reference" href="/categories/meta.html">meta</a> (1)</li>
            <li><a class="reference" href="/categories/numpy.html">numpy</a> (24)</li>
            <li><a class="reference" href="/categories/parser.html">parser</a> (1)</li>
            <li><a class="reference" href="/categories/performance.html">performance</a> (2)</li>
            <li><a class="reference" href="/categories/profiling.html">profiling</a> (7)</li>
            <li><a class="reference" href="/categories/pypy.html">pypy</a> (6)</li>
            <li><a class="reference" href="/categories/pypy3.html">pypy3</a> (16)</li>
            <li><a class="reference" href="/categories/pyqt4.html">PyQt4</a> (1)</li>
            <li><a class="reference" href="/categories/release.html">release</a> (66)</li>
            <li><a class="reference" href="/categories/releasecffi.html">releasecffi</a> (3)</li>
            <li><a class="reference" href="/categories/releaserevdb.html">releaserevdb</a> (1)</li>
            <li><a class="reference" href="/categories/releasestm.html">releasestm</a> (1)</li>
            <li><a class="reference" href="/categories/revdb.html">revdb</a> (1)</li>
            <li><a class="reference" href="/categories/roadmap.html">roadmap</a> (2)</li>
            <li><a class="reference" href="/categories/rpython.html">rpython</a> (1)</li>
            <li><a class="reference" href="/categories/rpyc.html">RPyC</a> (1)</li>
            <li><a class="reference" href="/categories/speed.html">speed</a> (6)</li>
            <li><a class="reference" href="/categories/sponsors.html">sponsors</a> (7)</li>
            <li><a class="reference" href="/categories/sprint.html">sprint</a> (3)</li>
            <li><a class="reference" href="/categories/sprints.html">sprints</a> (1)</li>
            <li><a class="reference" href="/categories/stm.html">stm</a> (14)</li>
            <li><a class="reference" href="/categories/sun.html">sun</a> (1)</li>
            <li><a class="reference" href="/categories/smalltalk.html">Smalltalk</a> (1)</li>
            <li><a class="reference" href="/categories/squeak.html">Squeak</a> (1)</li>
            <li><a class="reference" href="/categories/testing.html">testing</a> (1)</li>
            <li><a class="reference" href="/categories/toy-optimizer.html">toy-optimizer</a> (6)</li>
            <li><a class="reference" href="/categories/unicode.html">unicode</a> (1)</li>
            <li><a class="reference" href="/categories/valgrind.html">valgrind</a> (1)</li>
            <li><a class="reference" href="/categories/vmprof.html">vmprof</a> (3)</li>
            <li><a class="reference" href="/categories/z3.html">z3</a> (5)</li>
          </ul>
        </div>    </div>
</article></main><footer id="footer"><p>
</p>
<div class="myfooter">
  <div class="logotext">
    © 2026 <a href="mailto:pypy-dev@pypy.org">The PyPy Team</a>
     
    Built with <a href="https://getnikola.com" rel="nofollow">Nikola</a>
     
    Last built 2026-01-17T00:22
  </div>
  <div style="margin-left: auto">
  <a href="../../../rss.xml">RSS feed</a>
</div>

            
        

    </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" crossorigin="anonymous"></script><script src="../../../assets/js/styles.js"></script></footer>
</div>
</body>
</html>